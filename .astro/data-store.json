[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.15.9","content-config-digest","654dd276434d3e65","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://ghonk.github.io\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false},\"legacy\":{\"collections\":false}}","blog",["Map",11,12,33,34,53,54,71,72,89,90,107,108,126,127,142,143,221,222,331,332,476,477,494,495,513,514,530,531,547,548,565,566,582,583,599,600,616,617,634,635,652,653,670,671,687,688,705,706,723,724,740,741,757,758,774,775,793,794,810,811,827,828,844,845,862,863,880,881,898,899,916,917,933,934,951,952,968,969,985,986,1002,1003,1020,1021,1039,1040],"2014-9-1-analogical-learning-in-museum",{"id":11,"data":13,"filePath":22,"digest":23,"rendered":24,"legacyId":32},{"title":14,"excerpt":15,"tags":16,"season":17,"assets":18,"type":19,"external_url":20,"layout":21},"Rapid Learning in a Children’s Museum via Analogical Comparison","Paper on analogical learning at the Chicago Children's Museum accepted for publication at Cognitive Science","analogy, cognition, paper","fall 2014","none","pdf","/pdfs/manuscripts/Gentner-et-al-2016-Museum.pdf","external","src/content/blog/2014-9-1-analogical-learning-in-museum.md","58f4ccf5a1c10065",{"html":25,"metadata":26},"",{"headings":27,"localImagePaths":28,"remoteImagePaths":29,"frontmatter":30,"imagePaths":31},[],[],[],{"title":14,"excerpt":15,"tags":16,"season":17,"assets":18,"type":19,"external_url":20,"layout":21},[],"2014-9-1-analogical-learning-in-museum.md","2012-8-29-safest-route-to-bing",{"id":33,"data":35,"body":41,"filePath":42,"digest":43,"rendered":44,"legacyId":52},{"title":36,"excerpt":37,"tags":38,"season":39,"type":9,"layout":40},"Safest Route to Binghamton University","Safest Bike Route from Binghamton (city) to Binghamton (university)","cycling, binghamton, biking","summer 2012","post","Hello! Hopefully you found this page because you were looking for a convenient and safe route to Binghamton University from anywhere in Binghamton \"proper\". \n\n*Some background.* This is the safest route I have found to get to Binghamton University assuming you're coming from the general vicinity of central Binghamton. After several years' experience biking in much larger cities, I was surprised to find that biking in Binghamton made me uncomfortable at times, and this route helped to alleviate much of that stress (at least for my daily commute). \n\nThere are a few modest climbs, but after a few trips you'll hardly even notice them! If you *really* want to get your blood pumping there are a few places you can take a left off of Moore to add a bit more climbing to the trip.\n\n*Note.* This route is most efficient if you are east of, say, Beethoven Street on Binghamton's west side. Even if you aren't you might prefer this route---especially in the winter when the bike lanes and sidewalks of the 201 bridge are not cleared of ice and debris (yea, like all winter). Happy Trails!\n\n*Update.* A fully-featured dedicated bike path [is in the works](http://www.pressconnects.com/story/news/local/2016/04/29/trail-blazing-16m-pedestrian-route-would-link-bu-downtown/82344124/) to link Binghamton University to downtown, so thank your government officials for addressing this problem. \n\n\u003Ciframe src=\"https://www.google.com/maps/d/u/0/embed?mid=1OkUodDDf2kCKFbrXyYXtxfb0aqUo_Cdr\" width=\"640\" height=\"480\">\u003C/iframe>\n\n\n\nStep-by-step directions:\n\n\u003Ctable style=\"width:100%\">\n  \u003Ctr>\n    \u003Cth>Direction\u003C/th>\n    \u003Cth>Distance\u003C/th> \n  \u003C/tr>\n  \u003Ctr>\n    \u003Ctd>Take the pedestrian bridge across the Susquehanna River\u003C/td>\n    \u003Ctd>\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn right onto Pennsylvania Ave\u003C/td>\n    \u003Ctd>92 ft\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Slight left to stay on Pennsylvania Ave\u003C/td>\n    \u003Ctd>0.694 mi\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn right onto Moore Ave\u003C/td>\n    \u003Ctd>0.873 mi\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn right onto Hazard Hill Rd\u003C/td>\n    \u003Ctd>262 ft\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Continue onto Hawthorne Rd\u003C/td>\n    \u003Ctd>1,168 ft\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn left onto Clifton Blvd\u003C/td>\n    \u003Ctd>0.925 mi\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn left onto Clubhouse Rd\u003C/td>\n    \u003Ctd>0.413 mi\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn left onto Country Club Rd\u003C/td>\n    \u003Ctd>0.314 mi\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn right onto Washington Dr\u003C/td>\n    \u003Ctd>0.290 mi\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Turn right onto Lehigh Ave\u003C/td>\n    \u003Ctd>341 ft\u003C/td> \n  \u003C/tr>\n  \n    \u003Ctr>\n    \u003Ctd>Continue onto E Access Rd til you're there!\u003C/td>\n    \u003Ctd>\u003C/td> \n  \u003C/tr>\n\n\u003C/table>","src/content/blog/2012-8-29-safest-route-to-bing.md","581e85995f01c8c4",{"html":45,"metadata":46},"\u003Cp>Hello! Hopefully you found this page because you were looking for a convenient and safe route to Binghamton University from anywhere in Binghamton “proper”.\u003C/p>\n\u003Cp>\u003Cem>Some background.\u003C/em> This is the safest route I have found to get to Binghamton University assuming you’re coming from the general vicinity of central Binghamton. After several years’ experience biking in much larger cities, I was surprised to find that biking in Binghamton made me uncomfortable at times, and this route helped to alleviate much of that stress (at least for my daily commute).\u003C/p>\n\u003Cp>There are a few modest climbs, but after a few trips you’ll hardly even notice them! If you \u003Cem>really\u003C/em> want to get your blood pumping there are a few places you can take a left off of Moore to add a bit more climbing to the trip.\u003C/p>\n\u003Cp>\u003Cem>Note.\u003C/em> This route is most efficient if you are east of, say, Beethoven Street on Binghamton’s west side. Even if you aren’t you might prefer this route---especially in the winter when the bike lanes and sidewalks of the 201 bridge are not cleared of ice and debris (yea, like all winter). Happy Trails!\u003C/p>\n\u003Cp>\u003Cem>Update.\u003C/em> A fully-featured dedicated bike path \u003Ca href=\"http://www.pressconnects.com/story/news/local/2016/04/29/trail-blazing-16m-pedestrian-route-would-link-bu-downtown/82344124/\">is in the works\u003C/a> to link Binghamton University to downtown, so thank your government officials for addressing this problem.\u003C/p>\n\u003Ciframe src=\"https://www.google.com/maps/d/u/0/embed?mid=1OkUodDDf2kCKFbrXyYXtxfb0aqUo_Cdr\" width=\"640\" height=\"480\">\u003C/iframe>\n\u003Cp>Step-by-step directions:\u003C/p>\n\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn right onto Pennsylvania Ave&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>92 ft&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Slight left to stay on Pennsylvania Ave&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>0.694 mi&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn right onto Moore Ave&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>0.873 mi&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn right onto Hazard Hill Rd&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>262 ft&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Continue onto Hawthorne Rd&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>1,168 ft&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn left onto Clifton Blvd&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>0.925 mi&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn left onto Clubhouse Rd&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>0.413 mi&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn left onto Country Club Rd&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>0.314 mi&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn right onto Washington Dr&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>0.290 mi&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Turn right onto Lehigh Ave&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>341 ft&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>&#x3C;tr>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>Continue onto E Access Rd til you're there!&#x3C;/td>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;td>&#x3C;/td> \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n  \n\u003Ctable style=\"width:100%\">\n  \u003Ctbody>\u003Ctr>\n    \u003Cth>Direction\u003C/th>\n    \u003Cth>Distance\u003C/th> \n  \u003C/tr>\n  \u003Ctr>\n    \u003Ctd>Take the pedestrian bridge across the Susquehanna River\u003C/td>\n    \u003Ctd>\u003C/td> \n  \u003C/tr>\u003C/tbody>\u003C/table>",{"headings":47,"localImagePaths":48,"remoteImagePaths":49,"frontmatter":50,"imagePaths":51},[],[],[],{"title":36,"excerpt":37,"tags":38,"season":39,"type":9,"layout":40},[],"2012-8-29-safest-route-to-bing.md","2017-11-30-thematic-intrusion-dissertation",{"id":53,"data":55,"filePath":61,"digest":62,"rendered":63,"legacyId":70},{"title":56,"excerpt":57,"tags":58,"season":59,"assets":18,"type":19,"external_url":60,"layout":21},"Causes and Predictors of Thematic Intrusion on Human Similarity Judgments","I successfully defended my dissertation, a behavioral and electrophysiological investigation of human similarity judgments.","taxonomic similarity, thematic association, neuroscience","fall 2017","/pdfs/manuscripts/honke2017final.pdf","src/content/blog/2017-11-30-thematic-intrusion-dissertation.md","681a630f58e5cd3c",{"html":25,"metadata":64},{"headings":65,"localImagePaths":66,"remoteImagePaths":67,"frontmatter":68,"imagePaths":69},[],[],[],{"title":56,"excerpt":57,"tags":58,"season":59,"assets":18,"type":19,"external_url":60,"layout":21},[],"2017-11-30-thematic-intrusion-dissertation.md","2015-7-1-aera-catcon",{"id":71,"data":73,"filePath":79,"digest":80,"rendered":81,"legacyId":88},{"title":74,"excerpt":75,"tags":76,"season":77,"assets":18,"type":19,"external_url":78,"layout":21},"Promoting transfer and mastery of evolution concepts with category construction","Presented a paper on teaching for transfer in middle school science at the American Educational Research Association annual meeting","transfer, cognition, paper, category, construction","summer 2015","/pdfs/manuscripts/honke-et-al-2015.pdf","src/content/blog/2015-7-1-aera-catcon.md","6746832a69b6564e",{"html":25,"metadata":82},{"headings":83,"localImagePaths":84,"remoteImagePaths":85,"frontmatter":86,"imagePaths":87},[],[],[],{"title":74,"excerpt":75,"tags":76,"season":77,"assets":18,"type":19,"external_url":78,"layout":21},[],"2015-7-1-aera-catcon.md","2016-7-1-cogsci2016",{"id":89,"data":91,"filePath":97,"digest":98,"rendered":99,"legacyId":106},{"title":92,"excerpt":93,"tags":94,"season":95,"assets":18,"type":19,"external_url":96,"layout":21},"Category Learning via Feature Switching","I gave a talk at CogSci 2016 on learning categories via feature switching. Here's the paper.","CogSci, category learning","summer 2016","/pdfs/manuscripts/honke-conaway-kurtz2016.pdf","src/content/blog/2016-7-1-cogsci2016.md","12892205166c4225",{"html":25,"metadata":100},{"headings":101,"localImagePaths":102,"remoteImagePaths":103,"frontmatter":104,"imagePaths":105},[],[],[],{"title":92,"excerpt":93,"tags":94,"season":95,"assets":18,"type":19,"external_url":96,"layout":21},[],"2016-7-1-cogsci2016.md","2017-2-23-catlearn-diva",{"id":107,"data":109,"filePath":116,"digest":117,"rendered":118,"legacyId":125},{"title":110,"excerpt":111,"tags":112,"season":113,"assets":18,"type":114,"external_url":115,"layout":21},"Catlearn DIVA Package","I wrote a DIVA (DIVergent Autoencoder) model for the Catlearn R library","R, DIVA","spring 2017","code","https://CRAN.R-project.org/package=catlearn","src/content/blog/2017-2-23-catlearn-diva.md","dd2867e5efdae1c0",{"html":25,"metadata":119},{"headings":120,"localImagePaths":121,"remoteImagePaths":122,"frontmatter":123,"imagePaths":124},[],[],[],{"title":110,"excerpt":111,"tags":112,"season":113,"assets":18,"type":114,"external_url":115,"layout":21},[],"2017-2-23-catlearn-diva.md","2017-2-24-catlearn-suppls-annouce",{"id":126,"data":128,"filePath":132,"digest":133,"rendered":134,"legacyId":141},{"title":129,"excerpt":130,"tags":112,"season":113,"assets":18,"type":114,"external_url":131,"layout":21},"Catlearn Supplementals Package","Nolan Conaway and I wrote a suite of helper functions to assist with modeling in the Catlearn ecosystem","https://github.com/ghonk/catlearn.suppls","src/content/blog/2017-2-24-catlearn-suppls-annouce.md","8645e7002769aa1d",{"html":25,"metadata":135},{"headings":136,"localImagePaths":137,"remoteImagePaths":138,"frontmatter":139,"imagePaths":140},[],[],[],{"title":129,"excerpt":130,"tags":112,"season":113,"assets":18,"type":114,"external_url":131,"layout":21},[],"2017-2-24-catlearn-suppls-annouce.md","2017-12-20-roa-lstm",{"id":142,"data":144,"body":148,"filePath":149,"digest":150,"rendered":151,"legacyId":220},{"title":145,"excerpt":145,"tags":146,"season":147,"type":9,"layout":40},"Experimenting with text generation to create novel Ferengi Rules of Acquisition","ml, datascience, startrek, LSTM","winter 2017","### This post presents an *evolving* attempt to generate novel Ferengi Rules of Acquisition with classic and contemporary approaches to natural language processing. \n\n![timely](/assets/imgs/roa.jpg)\n\n### The Ferengi are a species of uber-capitalists with a 1950's mentality re: social issues that exist in the Star Trek Universe. The Rules of Acquisition are one part governmental charter, one part values system. They're written as proverbs, so they're naturally short and there aren't a ton of them (~138 in the comprehensive Star Trek universe). In their [own words](https://en.wikipedia.org/wiki/Rules_of_Acquisition):\n\n> \"Every Ferengi business transaction is governed by 285 Rules of Acquisition to ensure a fair and honest deal for all parties concerned... well most of them anyway.\" - Quark, \"The Maquis: Part 1\". Star Trek: Deep Space Nine\n\n### This means it should be a bit of a challenge to train up an LSTM to generate novel and sensible additions. On the other hand---as you might expect from the socio-cultrual guidelines for a socially-backwards, profit-at-all-costs society---the themes of the Rules are limited, suggesting that a fairly vanilla LSTM might be able to a decent job.   \n\n_________\n\nFirst Attempt: This approach uses an LSTM to generate character-by-character predictions after training on the Rules as a solid block of text. This approach was *heavily* inspired by Jason Brownlee's blog [post](https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/). \n\n\n# LSTM on the Ferengi Rules of Acquisition\n\n## getting the rules\n\n#### load some packages\n\n\n```python\nimport requests\nfrom bs4 import BeautifulSoup\n\ndef getMiddleColumnFromRow(row):\n    return row.findAll('td')[1].text.strip()\n```\n\n#### grab the text\n\n\n```python\nresponse = requests.get(\n     'http://memory-beta.wikia.com/wiki/Ferengi_Rules_of_Acquisition'\n)\n```\n\n\n```python\nsoup = BeautifulSoup(response.content,'lxml')\nrules = list(map(getMiddleColumnFromRow, soup.find('table').findAll('tr')))\nrules = rules[1:len(rules)]\n```\n\n#### clean up the text\n\n\n```python\nrules = [s.lower() for s in rules]\nrules_block = \" \".join(rules)\nrules_block = rules_block.replace('\"', '').replace('*', '').replace('[', '').replace(']', '')\n```\n\n#### build a dict with all the characters\n\n\n```python\nchars = sorted(list(set(rules_block)))\nchars_to_int = dict((c, i) for i, c in enumerate(chars))\n```\n\n#### basic text properties\n\n\n```python\nn_chars = len(rules_block)\nn_vocab = len(chars)\nprint(\"Total Characters: \", n_chars)\nprint(\"Total Vocab: \", n_vocab)\n```\n\n    Total Characters:  6155\n    Total Vocab:  36\n\n\n#### advanced properties / ins and outs\n\n\n```python\nseq_length = 100\ndataX = []\ndataY = []\nfor i in range(0, n_chars - seq_length, 1):\n\tseq_in = rules_block[i:i + seq_length]\n\tseq_out = rules_block[i + seq_length]\n\tdataX.append([chars_to_int[char] for char in seq_in])\n\tdataY.append(chars_to_int[seq_out])\nn_patterns = len(dataX)\nprint(\"Total Patterns: \", n_patterns)\n```\n\n    Total Patterns:  6055\n\n\n## set up the model\n\n\n```python\nimport numpy as np\nimport sys\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Dropout\nfrom keras.layers import LSTM\nfrom keras.callbacks import ModelCheckpoint\nfrom keras.utils import np_utils\n```\n\n#### create input/output encodings\n\n\n```python\n# reshape X to be [samples, time steps, features]\nX = np.reshape(dataX, (n_patterns, seq_length, 1))\n# normalize\nX = X / float(n_vocab)\n# one hot encode the output variable\ny = np_utils.to_categorical(dataY)\n```\n\n#### set model params\n\n\n```python\n# define the LSTM model\nmodel = Sequential()\nmodel.add(LSTM(256, input_shape = (X.shape[1], X.shape[2])))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(y.shape[1], activation = 'softmax'))\nmodel.compile(loss = 'categorical_crossentropy', optimizer = 'adam')\n```\n\n#### setup checkpointing regime\n\n\n```python\n# define the checkpoint\nfilepath = \"weights-improvement-{epoch:02d}-{loss:.4f}.hdf5\"\ncheckpoint = ModelCheckpoint(filepath, monitor='loss', verbose=1, save_best_only=True, mode='min')\ncallbacks_list = [checkpoint]\n```\n\n#### run the model\n\n\n```python\nmodel.fit(X, y, epochs = 60, batch_size = 128, callbacks = callbacks_list)\n```\n\n    Epoch 1/60\n    6016/6055 [============================>.] - ETA: 0s - loss: 0.4661\n    Epoch 00001: loss did not improve\n    6055/6055 [==============================] - 45s 7ms/step - loss: 0.4655\n    Epoch 2/60\n    6016/6055 [============================>.] - ETA: 0s - loss: 0.3908\n    Epoch 00002: loss improved from 0.42985 to 0.39136, saving model to weights-improvement-02-0.3914.hdf5\n    6055/6055 [==============================] - 41s 7ms/step - loss: 0.3914\n    Epoch 3/60\n    6016/6055 [============================>.] - ETA: 0s - loss: 0.3774\n    Epoch 00003: loss improved from 0.39136 to 0.37890, saving model to weights-improvement-03-0.3789.hdf5\n    6055/6055 [==============================] - 57s 9ms/step - loss: 0.3789\n    Epoch 4/60\n    6016/6055 [============================>.] - ETA: 0s - loss: 0.5022\n    Epoch 00004: loss did not improve\n    6055/6055 [==============================] - 64s 11ms/step - loss: 0.5020\n    Epoch 5/60\n    6016/6055 [============================>.] - ETA: 0s - loss: 0.3542\n    Epoch 00005: loss improved from 0.37890 to 0.35414, saving model to weights-improvement-05-0.3541.hdf5\n    6055/6055 [==============================] - 53s 9ms/step - loss: 0.3541\n\n...\n\n    Epoch 60/60\n    6016/6055 [============================>.] - ETA: 0s - loss: 2.8709\n    Epoch 00060: loss did not improve\n    \n    \u003Ckeras.callbacks.History at 0x7fc8fbad9e10>\n\n\n\n## checking out the result\n\n#### after ~200 epochs we see some progress\n\n\n```python\n# load the network weights\nfilename = \"weights-improvement-19-0.2142.hdf5\"\nmodel.load_weights(filename)\nmodel.compile(loss = 'categorical_crossentropy', optimizer = 'adam')\n```\n\n\n```python\nint_to_char = dict((i, c) for i, c in enumerate(chars))\n\n# pick a random seed\nstart = np.random.randint(0, len(dataX)-1)\npattern = dataX[start]\nprint(\"Seed: \")\nprint(\"\\\"\", ''.join([int_to_char[value] for value in pattern]), \"\\\"\")\n# generate characters\nfor i in range(1000):\n\tx = numpy.reshape(pattern, (1, len(pattern), 1))\n\tx = x / float(n_vocab)\n\tprediction = model.predict(x, verbose = 0)\n\tindex = numpy.argmax(prediction)\n\tresult = int_to_char[index]\n\tseq_in = [int_to_char[value] for value in pattern]\n\tsys.stdout.write(result)\n\tpattern.append(index)\n\tpattern = pattern[1:len(pattern)]\nprint(\"\\nDone.\")\n```\n\n    Seed: \n    \" t ain't broke, don't fix it. deep down, everyone's a ferengi. no good deed ever goes unpunished. alw \"\n    ays get somebody else to do the lifting. never get into anything that you can't get out of. \n    a man is only worth the sum of his possessions. an angry man is an enemy, and a satisfied man is an ally.. \n    the less employees know about the cash flow, the smaller the share they can demand. \n    only a fool passes up a business opportunity. the more time they take deciding, the more money they will spend.\n    s tor tear your far dom ner rasi foomims ts neon aootn nn meeee. \n    teel if pollh n  eaat irdi yeu cen bbtat tat seth too canio met ss aoos rntr toer tsmk to necd anp llow waat it aoot fn aatinem. \n    m mere ssut  on betior lat s tele.t tooeins, wever teee  mrrorian tsene aacitsieni woane auuunens is erre \n    aesineess th neal you can beeter take a venetaoe tho merd nothods ianere thtnh torr aon bdsicesiit  lhver allon famile to \n    stald to shof t  is oo whe woust oo time tomk toonits in toe einhenier the merce thsesns in  lm yher ysur arrfdds bo  \n    lhver tekes. foead is the ienllfie iome tour presi seene's fothing\n    Done.\n\n\n#### at $loss \\leq .06$ we've overfit the data; closer inspection suggests that's *all* we're doing\n\n\n```python\n# load the network weights\nfilename = \"weights-improvement-54-0.0554.hdf5\"\nmodel.load_weights(filename)\nmodel.compile(loss = 'categorical_crossentropy', optimizer = 'adam')\n```\n\n\n```python\nint_to_char = dict((i, c) for i, c in enumerate(chars))\n\n# pick a random seed\nstart = np.random.randint(0, len(dataX)-1)\npattern = dataX[start]\nprint(\"Seed: \")\nprint(\"\\\"\", ''.join([int_to_char[value] for value in pattern]), \"\\\"\")\n# generate characters\nfor i in range(1000):\n\tx = numpy.reshape(pattern, (1, len(pattern), 1))\n\tx = x / float(n_vocab)\n\tprediction = model.predict(x, verbose = 0)\n\tindex = numpy.argmax(prediction)\n\tresult = int_to_char[index]\n\tseq_in = [int_to_char[value] for value in pattern]\n\tsys.stdout.write(result)\n\tpattern.append(index)\n\tpattern = pattern[1:len(pattern)]\nprint(\"\\nDone.\")\n```\n\n    Seed: \n    \" etter suit than your own. the bigger the smile, the sharper the knife. never ask when you can take.  \"\n    never trust anybody taller than you. rate divided by time equals profit. (also known as the velocity of wealth.) \n    take joy from profit, and profit from joy. good customers are as rare as latinum. treasure them. there is no substitute for success.\n    free advice is seldom cheap. keep your lies consistent. the riskier the road, the greater the profit. \n    work is the best therapy-at least for your employees. win or lose, there's always hupyrian beetle snuff. \n    someone's always got bigger ears. ferengi are not responsible for the stupidity of other races. knowledge equals profit. \n    home is where the heart is, but the stars are made of latinum. every once in a while, declare peace. \n    it confuses the hell out of your enemies. if you break it, i'll charge you for it! beware of the vulcan greed for knowledge. \n    the flimsier the product, the higher the price. never let the competition know what you're thinking. \n    learn the customer's weaknesses, so that you can better take advantage of him. it ain't over 'til i\n    Done.\n\n\n\n```python\nint_to_char = dict((i, c) for i, c in enumerate(chars))\n\n# pick a random seed\nstart = np.random.randint(0, len(dataX)-1)\npattern = dataX[start]\nprint(\"Seed: \")\nprint(\"\\\"\", ''.join([int_to_char[value] for value in pattern]), \"\\\"\")\n# generate characters\nfor i in range(1000):\n\tx = numpy.reshape(pattern, (1, len(pattern), 1))\n\tx = x / float(n_vocab)\n\tprediction = model.predict(x, verbose = 0)\n\tindex = numpy.argmax(prediction)\n\tresult = int_to_char[index]\n\tseq_in = [int_to_char[value] for value in pattern]\n\tsys.stdout.write(result)\n\tpattern.append(index)\n\tpattern = pattern[1:len(pattern)]\nprint(\"\\nDone.\")\n```\n\n    Seed: \n    \"  a product. time, like latinum, is a highly limited commodity. more is good...all is better. always  \"\n    leave yourself an out. a wife is a luxury... a smart accountant a neccessity. \n    when the messenger comes to appropriate your profits, kill the messenger. \n    a wealthy man can afford everything except a conscience. never let doubt interfere with your lust for latinum. \n    when in doubt, lie. always inspect the merchandise before making a deal. if it ain't broke, don't fix it. \n    deep down, everyone's a ferengi. no good deed ever goes unpunished. always get somebody else to do the lifting. \n    never get into anything that you can't get out of. a man is only worth the sum of his possessions. \n    an angry man is an enemy, and a satisfied man is an ally.. \n    the less employees know about the cash flow, the smaller the share they can demand. only a fool passes up a business opportunity.\n    the more time they take deciding, the more money they will spend.s aon thee tour frodit. fewares anx your fond berine. \n    sometimes what you get yrer cace to kropifs ts meol tou  atpi der oe yorrhit  novn ts need t erll frrm das. door\n    Done.\n\n\n\n```python\nint_to_char = dict((i, c) for i, c in enumerate(chars))\n\n# pick a random seed\nstart = np.random.randint(0, len(dataX)-1)\npattern = dataX[start]\nprint(\"Seed: \")\nprint(\"\\\"\", ''.join([int_to_char[value] for value in pattern]), \"\\\"\")\n# generate characters\nfor i in range(1000):\n\tx = numpy.reshape(pattern, (1, len(pattern), 1))\n\tx = x / float(n_vocab)\n\tprediction = model.predict(x, verbose = 0)\n\tindex = numpy.argmax(prediction)\n\tresult = int_to_char[index]\n\tseq_in = [int_to_char[value] for value in pattern]\n\tsys.stdout.write(result)\n\tpattern.append(index)\n\tpattern = pattern[1:len(pattern)]\nprint(\"\\nDone.\")\n```\n\n    Seed: \n    \"  wealthy man can afford everything except a conscience. never let doubt interfere with your lust for \"\n     latinum. when in doubt, lie. always inspect the merchandise before making a deal. if it ain't broke, don't fix it. \n     deep down, everyone's a ferengi. no good deed ever goes unpunished. always get somebody else to do the lifting. \n     never get into anything that you can't get out of. a man is only worth the sum of his possessions. \n     an angry man is an enemy, and a satisfied man is an ally.. the less employees know about the cash flow, the smaller the share they can demand. \n     only a fool passes up a business opportunity. the more time they take deciding, the more money they will spend.s aon thee tour frodit. \n     fewares anx your fond berine. sometimes what you get yrer cace to kropifs ts meol tou  atpi der oe yorrhit  novn ts need t erll frrm das. \n     dooreit is arofee..o lore as iotioess taah a qeeetiin  s mere sew letgo  lety asmayse dut mv wiat yhu can to feo .\n     on ortr thomiod thee y aow you  mead  rriedts it ee wete ns an bufey. aot yhe siace nhere l cela t  is anoeddeeee tht olly.\n     on khew touk ansioee\n    Done.\n\nSo, the character-by-character approach clearly is not working for us---the model has only learned to produce a verbatim replication of the input and we don't get any of the neat novelty we were hoping for. Note: this is before any parameter tuning, choosing some sensible defaults (e.g., the `adam` optimizer, unit dropout) and setting the input to character-by-character. \n\nThe biggest concern with LSTM on this project was that the data were simply too small to build a generative representation. No intermediate step produced good rules---steps only differed in their quality of identical replication of the character sequence. The choice of input as 100 character blocks might be increasing this identical text replication pattern. On the other hand, word-by-word prediction will produce an even smaller set of patterns. Stay tuned for the next iteration where a word-by-word LSTM will be examined.","src/content/blog/2017-12-20-roa-lstm.md","e61efef2f1cc404f",{"html":152,"metadata":153},"\u003Ch3 id=\"this-post-presents-an-evolving-attempt-to-generate-novel-ferengi-rules-of-acquisition-with-classic-and-contemporary-approaches-to-natural-language-processing\">This post presents an \u003Cem>evolving\u003C/em> attempt to generate novel Ferengi Rules of Acquisition with classic and contemporary approaches to natural language processing.\u003C/h3>\n\u003Cp>\u003Cimg src=\"/assets/imgs/roa.jpg\" alt=\"timely\">\u003C/p>\n\u003Ch3 id=\"the-ferengi-are-a-species-of-uber-capitalists-with-a-1950s-mentality-re-social-issues-that-exist-in-the-star-trek-universe-the-rules-of-acquisition-are-one-part-governmental-charter-one-part-values-system-theyre-written-as-proverbs-so-theyre-naturally-short-and-there-arent-a-ton-of-them-138-in-the-comprehensive-star-trek-universe-in-their-own-words\">The Ferengi are a species of uber-capitalists with a 1950’s mentality re: social issues that exist in the Star Trek Universe. The Rules of Acquisition are one part governmental charter, one part values system. They’re written as proverbs, so they’re naturally short and there aren’t a ton of them (~138 in the comprehensive Star Trek universe). In their \u003Ca href=\"https://en.wikipedia.org/wiki/Rules_of_Acquisition\">own words\u003C/a>:\u003C/h3>\n\u003Cblockquote>\n\u003Cp>“Every Ferengi business transaction is governed by 285 Rules of Acquisition to ensure a fair and honest deal for all parties concerned… well most of them anyway.” - Quark, “The Maquis: Part 1”. Star Trek: Deep Space Nine\u003C/p>\n\u003C/blockquote>\n\u003Ch3 id=\"this-means-it-should-be-a-bit-of-a-challenge-to-train-up-an-lstm-to-generate-novel-and-sensible-additions-on-the-other-hand---as-you-might-expect-from-the-socio-cultrual-guidelines-for-a-socially-backwards-profit-at-all-costs-society---the-themes-of-the-rules-are-limited-suggesting-that-a-fairly-vanilla-lstm-might-be-able-to-a-decent-job\">This means it should be a bit of a challenge to train up an LSTM to generate novel and sensible additions. On the other hand---as you might expect from the socio-cultrual guidelines for a socially-backwards, profit-at-all-costs society---the themes of the Rules are limited, suggesting that a fairly vanilla LSTM might be able to a decent job.\u003C/h3>\n\u003Chr>\n\u003Cp>First Attempt: This approach uses an LSTM to generate character-by-character predictions after training on the Rules as a solid block of text. This approach was \u003Cem>heavily\u003C/em> inspired by Jason Brownlee’s blog \u003Ca href=\"https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/\">post\u003C/a>.\u003C/p>\n\u003Ch1 id=\"lstm-on-the-ferengi-rules-of-acquisition\">LSTM on the Ferengi Rules of Acquisition\u003C/h1>\n\u003Ch2 id=\"getting-the-rules\">getting the rules\u003C/h2>\n\u003Ch4 id=\"load-some-packages\">load some packages\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> requests\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> bs4 \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> BeautifulSoup\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> getMiddleColumnFromRow\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(row):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> row.findAll(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'td'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].text.strip()\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"grab-the-text\">grab the text\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">response \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> requests.get(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">     'http://memory-beta.wikia.com/wiki/Ferengi_Rules_of_Acquisition'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">soup \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> BeautifulSoup(response.content,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'lxml'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rules \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> list\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">map\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(getMiddleColumnFromRow, soup.find(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'table'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).findAll(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'tr'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rules \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rules[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(rules)]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"clean-up-the-text\">clean up the text\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rules \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [s.lower() \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> s \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rules]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rules_block \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \" \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.join(rules)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rules_block \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rules_block.replace(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\"'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).replace(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'*'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).replace(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'['\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).replace(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">']'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"build-a-dict-with-all-the-characters\">build a dict with all the characters\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">chars \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> sorted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">list\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">set\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(rules_block)))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">chars_to_int \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dict\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((c, i) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i, c \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(chars))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"basic-text-properties\">basic text properties\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">n_chars \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(rules_block)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">n_vocab \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(chars)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Total Characters: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, n_chars)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Total Vocab: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, n_vocab)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Total Characters:  6155\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Total Vocab:  36\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"advanced-properties--ins-and-outs\">advanced properties / ins and outs\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">seq_length \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 100\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">dataX \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">dataY \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, n_chars \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> seq_length, \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tseq_in \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rules_block[i:i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> seq_length]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tseq_out \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rules_block[i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> seq_length]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tdataX.append([chars_to_int[char] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> char \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> seq_in])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tdataY.append(chars_to_int[seq_out])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">n_patterns \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(dataX)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Total Patterns: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, n_patterns)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Total Patterns:  6055\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"set-up-the-model\">set up the model\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keras.models \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Sequential\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keras.layers \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Dense\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keras.layers \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Dropout\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keras.layers \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#79B8FF\"> LSTM\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keras.callbacks \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ModelCheckpoint\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keras.utils \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np_utils\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"create-inputoutput-encodings\">create input/output encodings\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># reshape X to be [samples, time steps, features]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">X \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np.reshape(dataX, (n_patterns, seq_length, \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># normalize\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">X \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> X \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> float\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(n_vocab)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># one hot encode the output variable\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">y \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np_utils.to_categorical(dataY)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"set-model-params\">set model params\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># define the LSTM model\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Sequential()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.add(LSTM(\u003C/span>\u003Cspan style=\"color:#79B8FF\">256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">input_shape\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (X.shape[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], X.shape[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">])))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.add(Dropout(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0.2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.add(Dense(y.shape[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], \u003C/span>\u003Cspan style=\"color:#FFAB70\">activation\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'softmax'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.compile(\u003C/span>\u003Cspan style=\"color:#FFAB70\">loss\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'categorical_crossentropy'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">optimizer\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'adam'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"setup-checkpointing-regime\">setup checkpointing regime\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># define the checkpoint\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">filepath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"weights-improvement-\u003C/span>\u003Cspan style=\"color:#79B8FF\">{epoch\u003C/span>\u003Cspan style=\"color:#F97583\">:02d\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">{loss\u003C/span>\u003Cspan style=\"color:#F97583\">:.4f\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.hdf5\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">checkpoint \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ModelCheckpoint(filepath, \u003C/span>\u003Cspan style=\"color:#FFAB70\">monitor\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'loss'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">verbose\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">save_best_only\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">True\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">mode\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'min'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">callbacks_list \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [checkpoint]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"run-the-model\">run the model\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.fit(X, y, \u003C/span>\u003Cspan style=\"color:#FFAB70\">epochs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 60\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">batch_size\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 128\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">callbacks\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> callbacks_list)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Epoch 1/60\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6016/6055 [============================>.] - ETA: 0s - loss: 0.4661\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 00001: loss did not improve\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6055/6055 [==============================] - 45s 7ms/step - loss: 0.4655\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 2/60\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6016/6055 [============================>.] - ETA: 0s - loss: 0.3908\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 00002: loss improved from 0.42985 to 0.39136, saving model to weights-improvement-02-0.3914.hdf5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6055/6055 [==============================] - 41s 7ms/step - loss: 0.3914\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 3/60\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6016/6055 [============================>.] - ETA: 0s - loss: 0.3774\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 00003: loss improved from 0.39136 to 0.37890, saving model to weights-improvement-03-0.3789.hdf5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6055/6055 [==============================] - 57s 9ms/step - loss: 0.3789\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 4/60\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6016/6055 [============================>.] - ETA: 0s - loss: 0.5022\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 00004: loss did not improve\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6055/6055 [==============================] - 64s 11ms/step - loss: 0.5020\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 5/60\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6016/6055 [============================>.] - ETA: 0s - loss: 0.3542\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 00005: loss improved from 0.37890 to 0.35414, saving model to weights-improvement-05-0.3541.hdf5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6055/6055 [==============================] - 53s 9ms/step - loss: 0.3541\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>…\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Epoch 60/60\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>6016/6055 [============================>.] - ETA: 0s - loss: 2.8709\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Epoch 00060: loss did not improve\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>&#x3C;keras.callbacks.History at 0x7fc8fbad9e10>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"checking-out-the-result\">checking out the result\u003C/h2>\n\u003Ch4 id=\"after-200-epochs-we-see-some-progress\">after ~200 epochs we see some progress\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># load the network weights\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">filename \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"weights-improvement-19-0.2142.hdf5\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.load_weights(filename)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.compile(\u003C/span>\u003Cspan style=\"color:#FFAB70\">loss\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'categorical_crossentropy'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">optimizer\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'adam'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">int_to_char \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dict\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((i, c) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i, c \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(chars))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># pick a random seed\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">start \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np.random.randint(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(dataX)\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dataX[start]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Seed: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.join([int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]), \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># generate characters\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.reshape(pattern, (\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern), \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> x \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> float\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(n_vocab)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tprediction \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> model.predict(x, \u003C/span>\u003Cspan style=\"color:#FFAB70\">verbose\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tindex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.argmax(prediction)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tresult \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> int_to_char[index]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tseq_in \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tsys.stdout.write(result)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern.append(index)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Done.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Seed: \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\" t ain't broke, don't fix it. deep down, everyone's a ferengi. no good deed ever goes unpunished. alw \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>ays get somebody else to do the lifting. never get into anything that you can't get out of. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>a man is only worth the sum of his possessions. an angry man is an enemy, and a satisfied man is an ally.. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>the less employees know about the cash flow, the smaller the share they can demand. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>only a fool passes up a business opportunity. the more time they take deciding, the more money they will spend.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>s tor tear your far dom ner rasi foomims ts neon aootn nn meeee. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>teel if pollh n  eaat irdi yeu cen bbtat tat seth too canio met ss aoos rntr toer tsmk to necd anp llow waat it aoot fn aatinem. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>m mere ssut  on betior lat s tele.t tooeins, wever teee  mrrorian tsene aacitsieni woane auuunens is erre \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>aesineess th neal you can beeter take a venetaoe tho merd nothods ianere thtnh torr aon bdsicesiit  lhver allon famile to \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>stald to shof t  is oo whe woust oo time tomk toonits in toe einhenier the merce thsesns in  lm yher ysur arrfdds bo  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>lhver tekes. foead is the ienllfie iome tour presi seene's fothing\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Done.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"at-loss-leq-06-weve-overfit-the-data-closer-inspection-suggests-thats-all-were-doing\">at $loss \\leq .06$ we’ve overfit the data; closer inspection suggests that’s \u003Cem>all\u003C/em> we’re doing\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># load the network weights\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">filename \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"weights-improvement-54-0.0554.hdf5\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.load_weights(filename)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">model.compile(\u003C/span>\u003Cspan style=\"color:#FFAB70\">loss\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'categorical_crossentropy'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">optimizer\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'adam'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">int_to_char \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dict\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((i, c) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i, c \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(chars))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># pick a random seed\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">start \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np.random.randint(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(dataX)\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dataX[start]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Seed: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.join([int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]), \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># generate characters\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.reshape(pattern, (\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern), \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> x \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> float\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(n_vocab)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tprediction \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> model.predict(x, \u003C/span>\u003Cspan style=\"color:#FFAB70\">verbose\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tindex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.argmax(prediction)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tresult \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> int_to_char[index]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tseq_in \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tsys.stdout.write(result)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern.append(index)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Done.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Seed: \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\" etter suit than your own. the bigger the smile, the sharper the knife. never ask when you can take.  \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>never trust anybody taller than you. rate divided by time equals profit. (also known as the velocity of wealth.) \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>take joy from profit, and profit from joy. good customers are as rare as latinum. treasure them. there is no substitute for success.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>free advice is seldom cheap. keep your lies consistent. the riskier the road, the greater the profit. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>work is the best therapy-at least for your employees. win or lose, there's always hupyrian beetle snuff. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>someone's always got bigger ears. ferengi are not responsible for the stupidity of other races. knowledge equals profit. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>home is where the heart is, but the stars are made of latinum. every once in a while, declare peace. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>it confuses the hell out of your enemies. if you break it, i'll charge you for it! beware of the vulcan greed for knowledge. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>the flimsier the product, the higher the price. never let the competition know what you're thinking. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>learn the customer's weaknesses, so that you can better take advantage of him. it ain't over 'til i\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Done.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">int_to_char \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dict\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((i, c) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i, c \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(chars))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># pick a random seed\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">start \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np.random.randint(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(dataX)\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dataX[start]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Seed: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.join([int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]), \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># generate characters\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.reshape(pattern, (\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern), \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> x \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> float\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(n_vocab)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tprediction \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> model.predict(x, \u003C/span>\u003Cspan style=\"color:#FFAB70\">verbose\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tindex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.argmax(prediction)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tresult \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> int_to_char[index]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tseq_in \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tsys.stdout.write(result)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern.append(index)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Done.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Seed: \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\"  a product. time, like latinum, is a highly limited commodity. more is good...all is better. always  \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>leave yourself an out. a wife is a luxury... a smart accountant a neccessity. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>when the messenger comes to appropriate your profits, kill the messenger. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>a wealthy man can afford everything except a conscience. never let doubt interfere with your lust for latinum. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>when in doubt, lie. always inspect the merchandise before making a deal. if it ain't broke, don't fix it. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>deep down, everyone's a ferengi. no good deed ever goes unpunished. always get somebody else to do the lifting. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>never get into anything that you can't get out of. a man is only worth the sum of his possessions. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>an angry man is an enemy, and a satisfied man is an ally.. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>the less employees know about the cash flow, the smaller the share they can demand. only a fool passes up a business opportunity.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>the more time they take deciding, the more money they will spend.s aon thee tour frodit. fewares anx your fond berine. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>sometimes what you get yrer cace to kropifs ts meol tou  atpi der oe yorrhit  novn ts need t erll frrm das. door\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Done.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">int_to_char \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dict\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((i, c) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i, c \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(chars))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># pick a random seed\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">start \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> np.random.randint(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(dataX)\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dataX[start]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Seed: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.join([int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]), \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># generate characters\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.reshape(pattern, (\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern), \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> x \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> float\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(n_vocab)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tprediction \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> model.predict(x, \u003C/span>\u003Cspan style=\"color:#FFAB70\">verbose\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tindex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> numpy.argmax(prediction)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tresult \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> int_to_char[index]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tseq_in \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [int_to_char[value] \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> value \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tsys.stdout.write(result)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern.append(index)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\tpattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pattern[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\">len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pattern)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Done.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Seed: \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\"  wealthy man can afford everything except a conscience. never let doubt interfere with your lust for \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> latinum. when in doubt, lie. always inspect the merchandise before making a deal. if it ain't broke, don't fix it. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> deep down, everyone's a ferengi. no good deed ever goes unpunished. always get somebody else to do the lifting. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> never get into anything that you can't get out of. a man is only worth the sum of his possessions. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> an angry man is an enemy, and a satisfied man is an ally.. the less employees know about the cash flow, the smaller the share they can demand. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> only a fool passes up a business opportunity. the more time they take deciding, the more money they will spend.s aon thee tour frodit. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> fewares anx your fond berine. sometimes what you get yrer cace to kropifs ts meol tou  atpi der oe yorrhit  novn ts need t erll frrm das. \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> dooreit is arofee..o lore as iotioess taah a qeeetiin  s mere sew letgo  lety asmayse dut mv wiat yhu can to feo .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> on ortr thomiod thee y aow you  mead  rriedts it ee wete ns an bufey. aot yhe siace nhere l cela t  is anoeddeeee tht olly.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> on khew touk ansioee\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Done.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So, the character-by-character approach clearly is not working for us---the model has only learned to produce a verbatim replication of the input and we don’t get any of the neat novelty we were hoping for. Note: this is before any parameter tuning, choosing some sensible defaults (e.g., the \u003Ccode>adam\u003C/code> optimizer, unit dropout) and setting the input to character-by-character.\u003C/p>\n\u003Cp>The biggest concern with LSTM on this project was that the data were simply too small to build a generative representation. No intermediate step produced good rules---steps only differed in their quality of identical replication of the character sequence. The choice of input as 100 character blocks might be increasing this identical text replication pattern. On the other hand, word-by-word prediction will produce an even smaller set of patterns. Stay tuned for the next iteration where a word-by-word LSTM will be examined.\u003C/p>",{"headings":154,"localImagePaths":216,"remoteImagePaths":217,"frontmatter":218,"imagePaths":219},[155,159,162,165,169,173,177,180,183,186,189,192,195,198,201,204,207,210,213],{"depth":156,"slug":157,"text":158},3,"this-post-presents-an-evolving-attempt-to-generate-novel-ferengi-rules-of-acquisition-with-classic-and-contemporary-approaches-to-natural-language-processing","This post presents an evolving attempt to generate novel Ferengi Rules of Acquisition with classic and contemporary approaches to natural language processing.",{"depth":156,"slug":160,"text":161},"the-ferengi-are-a-species-of-uber-capitalists-with-a-1950s-mentality-re-social-issues-that-exist-in-the-star-trek-universe-the-rules-of-acquisition-are-one-part-governmental-charter-one-part-values-system-theyre-written-as-proverbs-so-theyre-naturally-short-and-there-arent-a-ton-of-them-138-in-the-comprehensive-star-trek-universe-in-their-own-words","The Ferengi are a species of uber-capitalists with a 1950’s mentality re: social issues that exist in the Star Trek Universe. The Rules of Acquisition are one part governmental charter, one part values system. They’re written as proverbs, so they’re naturally short and there aren’t a ton of them (~138 in the comprehensive Star Trek universe). In their own words:",{"depth":156,"slug":163,"text":164},"this-means-it-should-be-a-bit-of-a-challenge-to-train-up-an-lstm-to-generate-novel-and-sensible-additions-on-the-other-hand---as-you-might-expect-from-the-socio-cultrual-guidelines-for-a-socially-backwards-profit-at-all-costs-society---the-themes-of-the-rules-are-limited-suggesting-that-a-fairly-vanilla-lstm-might-be-able-to-a-decent-job","This means it should be a bit of a challenge to train up an LSTM to generate novel and sensible additions. On the other hand---as you might expect from the socio-cultrual guidelines for a socially-backwards, profit-at-all-costs society---the themes of the Rules are limited, suggesting that a fairly vanilla LSTM might be able to a decent job.",{"depth":166,"slug":167,"text":168},1,"lstm-on-the-ferengi-rules-of-acquisition","LSTM on the Ferengi Rules of Acquisition",{"depth":170,"slug":171,"text":172},2,"getting-the-rules","getting the rules",{"depth":174,"slug":175,"text":176},4,"load-some-packages","load some packages",{"depth":174,"slug":178,"text":179},"grab-the-text","grab the text",{"depth":174,"slug":181,"text":182},"clean-up-the-text","clean up the text",{"depth":174,"slug":184,"text":185},"build-a-dict-with-all-the-characters","build a dict with all the characters",{"depth":174,"slug":187,"text":188},"basic-text-properties","basic text properties",{"depth":174,"slug":190,"text":191},"advanced-properties--ins-and-outs","advanced properties / ins and outs",{"depth":170,"slug":193,"text":194},"set-up-the-model","set up the model",{"depth":174,"slug":196,"text":197},"create-inputoutput-encodings","create input/output encodings",{"depth":174,"slug":199,"text":200},"set-model-params","set model params",{"depth":174,"slug":202,"text":203},"setup-checkpointing-regime","setup checkpointing regime",{"depth":174,"slug":205,"text":206},"run-the-model","run the model",{"depth":170,"slug":208,"text":209},"checking-out-the-result","checking out the result",{"depth":174,"slug":211,"text":212},"after-200-epochs-we-see-some-progress","after ~200 epochs we see some progress",{"depth":174,"slug":214,"text":215},"at-loss-leq-06-weve-overfit-the-data-closer-inspection-suggests-thats-all-were-doing","at $loss \\leq .06$ we’ve overfit the data; closer inspection suggests that’s all we’re doing",[],[],{"title":145,"excerpt":145,"tags":146,"season":147,"type":9,"layout":40},[],"2017-12-20-roa-lstm.md","2017-7-30-catlearn-grid-search",{"id":221,"data":223,"body":228,"filePath":229,"digest":230,"rendered":231,"legacyId":330},{"title":224,"excerpt":225,"tags":226,"season":227,"type":9,"layout":40},"Grid Search with Catlearn and Catlearn Supplementals","Quick tutorial on grid search with Catlearn and Catlearn Supplementals","ml, datascience, DIVA","summer 2017","This is a brief demonstration of the grid search helper functions provided in `catlearn.suppls`. There are both parallelized and non-parallelized versions. \n\nload libraries \n\n\n{% highlight r %}\nlibrary(catlearn)\nlibrary(catlearn.suppls)\n{% endhighlight %}\n\n*initialize variables.* Create a named list for each hyperparameter you plan to test in the grid search, specify how many random model initializations you'd like to average across to calculate response probabilities for each parameter combination.  \n\n\n{% highlight r %}\n# # parameter list\nshort_param_list \u003C- list(beta_val = c(0, 1, 2, 3),\n                    learning_rate = c(.05, .10, .15),\n                         num_hids = c(4, 5, 6))\n\n# long_param_list \u003C- list(beta_val = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10),\n#                    learning_rate = c(.05, .10, .15, .20, .25, .35),\n#                         num_hids = c(4, 5, 6, 10, 20))\n\n# # # number of initializations\nnum_inits = 4\n\n# # # data\n# input_list \u003C- get_test_inputs('type1')\ninput_list \u003C- get_test_inputs('type4')\n\n# # # fit type\nfit_type \u003C- 'bestacc'\n\n# # # fit vector\ncrit_fit_vector \u003C- NULL\n{% endhighlight %}\n\nrun it\n\n\n{% highlight r %}\n# # # single core\nsystem.time(gs_output \u003C- diva_grid_search(short_param_list, num_inits, input_list))\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##    user  system elapsed \n##    3.95    0.00    3.99\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# # # parallelized\nsystem.time(gs_output \u003C- diva_grid_search_par(short_param_list, num_inits, input_list))\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##    user  system elapsed \n##    0.03    0.00    3.04\n{% endhighlight %}\n\nexamine the results with `plot_training`\n\n\n{% highlight r %}\nplot_training(lapply(gs_output, function(x) x$resp_probs))\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-16](/assets/rfigs/unnamed-chunk-16-1.svg)\n\nexamine the detailed results of a grid search run\n\n\n{% highlight r %}\n# # # how many paramter settings did we have?\n(n_models \u003C- length(gs_output))\n{% endhighlight %}\n\n\n\n{% highlight text %}\n## [1] 36\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# # # what was the accuracy distribution?\nfinal_accuracy \u003C- lapply(gs_output, function(x) {x$resp_probs[12]})\nplot(1:n_models, final_accuracy)\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-17](/assets/rfigs/unnamed-chunk-17-1.svg)\n\n{% highlight r %}\n# # # what parameter setting had the best performance?\ngs_output[[which.max(final_accuracy)]]$params\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##    beta_val learning_rate num_hids\n## 33        0          0.15        6\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# # # what parameter setting had the worst perfomance?\ngs_output[[which.min(final_accuracy)]]$params\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##   beta_val learning_rate num_hids\n## 7        2           0.1        4\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# # # plot em\nplot_training(list(gs_output[[which.max(final_accuracy)]]$resp_probs, \n  gs_output[[which.min(final_accuracy)]]$resp_probs))\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-17](/assets/rfigs/unnamed-chunk-17-2.svg)\n\n{% highlight r %}\n# # # what comes as output for each parameter setting?\nnames(gs_output[[which.max(final_accuracy)]])\n{% endhighlight %}\n\n\n\n{% highlight text %}\n## [1] \"resp_probs\" \"params\"     \"st\"\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# # # plot the training curves for a parameter subset (hid units = 5)\nhidunit5_respprobs \u003C- list()\nfor (i in 1:length(gs_output)) {\n  if (gs_output[[i]]$params$num_hids == 5){\n    hidunit5_respprobs[[paste0(i)]] \u003C- gs_output[[i]]$resp_probs\n  } \n}\n\n# # # how many?\n(n_models \u003C- length(hidunit5_respprobs))\n{% endhighlight %}\n\n\n\n{% highlight text %}\n## [1] 12\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# # # accuracy?\nplot(1:n_models, unlist(lapply(hidunit5_respprobs, function(x) x[[12]])))\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-17](/assets/rfigs/unnamed-chunk-17-3.svg)\n\n{% highlight r %}\nplot_training(hidunit5_respprobs)\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-17](/assets/rfigs/unnamed-chunk-17-4.svg)","src/content/blog/2017-7-30-catlearn-grid-search.md","6fa3f91f430db562",{"html":232,"metadata":233},"\u003Cp>This is a brief demonstration of the grid search helper functions provided in \u003Ccode>catlearn.suppls\u003C/code>. There are both parallelized and non-parallelized versions.\u003C/p>\n\u003Cp>load libraries\u003C/p>\n\u003Cp>{% highlight r %}\nlibrary(catlearn)\nlibrary(catlearn.suppls)\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cem>initialize variables.\u003C/em> Create a named list for each hyperparameter you plan to test in the grid search, specify how many random model initializations you’d like to average across to calculate response probabilities for each parameter combination.\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"-parameter-list\"># parameter list\u003C/h1>\n\u003Cp>short_param_list &#x3C;- list(beta_val = c(0, 1, 2, 3),\nlearning_rate = c(.05, .10, .15),\nnum_hids = c(4, 5, 6))\u003C/p>\n\u003Ch1 id=\"long_param_list---listbeta_val--c0-1-2-3-4-5-6-7-8-9-10\">long_param_list &#x3C;- list(beta_val = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10),\u003C/h1>\n\u003Ch1 id=\"learning_rate--c05-10-15-20-25-35\">learning_rate = c(.05, .10, .15, .20, .25, .35),\u003C/h1>\n\u003Ch1 id=\"num_hids--c4-5-6-10-20\">num_hids = c(4, 5, 6, 10, 20))\u003C/h1>\n\u003Ch1 id=\"--number-of-initializations\"># # number of initializations\u003C/h1>\n\u003Cp>num_inits = 4\u003C/p>\n\u003Ch1 id=\"--data\"># # data\u003C/h1>\n\u003Ch1 id=\"input_list---get_test_inputstype1\">input_list &#x3C;- get_test_inputs(‘type1’)\u003C/h1>\n\u003Cp>input_list &#x3C;- get_test_inputs(‘type4’)\u003C/p>\n\u003Ch1 id=\"--fit-type\"># # fit type\u003C/h1>\n\u003Cp>fit_type &#x3C;- ‘bestacc’\u003C/p>\n\u003Ch1 id=\"--fit-vector\"># # fit vector\u003C/h1>\n\u003Cp>crit_fit_vector &#x3C;- NULL\n{% endhighlight %}\u003C/p>\n\u003Cp>run it\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--single-core\"># # single core\u003C/h1>\n\u003Cp>system.time(gs_output &#x3C;- diva_grid_search(short_param_list, num_inits, input_list))\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"user--system-elapsed\">user  system elapsed\u003C/h2>\n\u003Ch2 id=\"395----000----399\">3.95    0.00    3.99\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--parallelized\"># # parallelized\u003C/h1>\n\u003Cp>system.time(gs_output &#x3C;- diva_grid_search_par(short_param_list, num_inits, input_list))\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"user--system-elapsed-1\">user  system elapsed\u003C/h2>\n\u003Ch2 id=\"003----000----304\">0.03    0.00    3.04\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>examine the results with \u003Ccode>plot_training\u003C/code>\u003C/p>\n\u003Cp>{% highlight r %}\nplot_training(lapply(gs_output, function(x) x$resp_probs))\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-16-1.svg\" alt=\"plot of chunk unnamed-chunk-16\">\u003C/p>\n\u003Cp>examine the detailed results of a grid search run\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--how-many-paramter-settings-did-we-have\"># # how many paramter settings did we have?\u003C/h1>\n\u003Cp>(n_models &#x3C;- length(gs_output))\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"1-36\">[1] 36\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--what-was-the-accuracy-distribution\"># # what was the accuracy distribution?\u003C/h1>\n\u003Cp>final_accuracy &#x3C;- lapply(gs_output, function(x) {x$resp_probs[12]})\nplot(1:n_models, final_accuracy)\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-17-1.svg\" alt=\"plot of chunk unnamed-chunk-17\">\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--what-parameter-setting-had-the-best-performance\"># # what parameter setting had the best performance?\u003C/h1>\n\u003Cp>gs_output[[which.max(final_accuracy)]]$params\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"beta_val-learning_rate-num_hids\">beta_val learning_rate num_hids\u003C/h2>\n\u003Ch2 id=\"33--------0----------015--------6\">33        0          0.15        6\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--what-parameter-setting-had-the-worst-perfomance\"># # what parameter setting had the worst perfomance?\u003C/h1>\n\u003Cp>gs_output[[which.min(final_accuracy)]]$params\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"beta_val-learning_rate-num_hids-1\">beta_val learning_rate num_hids\u003C/h2>\n\u003Ch2 id=\"7--------2-----------01--------4\">7        2           0.1        4\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--plot-em\"># # plot em\u003C/h1>\n\u003Cp>plot_training(list(gs_output[[which.max(final_accuracy)]]$resp_probs,\ngs_output[[which.min(final_accuracy)]]$resp_probs))\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-17-2.svg\" alt=\"plot of chunk unnamed-chunk-17\">\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--what-comes-as-output-for-each-parameter-setting\"># # what comes as output for each parameter setting?\u003C/h1>\n\u003Cp>names(gs_output[[which.max(final_accuracy)]])\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"1-resp_probs-params-----st\">[1] “resp_probs” “params”     “st”\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--plot-the-training-curves-for-a-parameter-subset-hid-units--5\"># # plot the training curves for a parameter subset (hid units = 5)\u003C/h1>\n\u003Cp>hidunit5_respprobs &#x3C;- list()\nfor (i in 1:length(gs_output)) {\nif (gs_output[[i]]$params$num_hids == 5){\nhidunit5_respprobs[[paste0(i)]] &#x3C;- gs_output[[i]]$resp_probs\n}\n}\u003C/p>\n\u003Ch1 id=\"--how-many\"># # how many?\u003C/h1>\n\u003Cp>(n_models &#x3C;- length(hidunit5_respprobs))\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"1-12\">[1] 12\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--accuracy\"># # accuracy?\u003C/h1>\n\u003Cp>plot(1:n_models, unlist(lapply(hidunit5_respprobs, function(x) x[[12]])))\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-17-3.svg\" alt=\"plot of chunk unnamed-chunk-17\">\u003C/p>\n\u003Cp>{% highlight r %}\nplot_training(hidunit5_respprobs)\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-17-4.svg\" alt=\"plot of chunk unnamed-chunk-17\">\u003C/p>",{"headings":234,"localImagePaths":326,"remoteImagePaths":327,"frontmatter":328,"imagePaths":329},[235,238,241,244,247,250,253,256,259,262,265,268,271,274,276,279,282,285,288,291,294,297,300,302,305,308,311,314,317,320,323],{"depth":166,"slug":236,"text":237},"-parameter-list","# parameter list",{"depth":166,"slug":239,"text":240},"long_param_list---listbeta_val--c0-1-2-3-4-5-6-7-8-9-10","long_param_list \u003C- list(beta_val = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10),",{"depth":166,"slug":242,"text":243},"learning_rate--c05-10-15-20-25-35","learning_rate = c(.05, .10, .15, .20, .25, .35),",{"depth":166,"slug":245,"text":246},"num_hids--c4-5-6-10-20","num_hids = c(4, 5, 6, 10, 20))",{"depth":166,"slug":248,"text":249},"--number-of-initializations","# # number of initializations",{"depth":166,"slug":251,"text":252},"--data","# # data",{"depth":166,"slug":254,"text":255},"input_list---get_test_inputstype1","input_list \u003C- get_test_inputs(‘type1’)",{"depth":166,"slug":257,"text":258},"--fit-type","# # fit type",{"depth":166,"slug":260,"text":261},"--fit-vector","# # fit vector",{"depth":166,"slug":263,"text":264},"--single-core","# # single core",{"depth":170,"slug":266,"text":267},"user--system-elapsed","user  system elapsed",{"depth":170,"slug":269,"text":270},"395----000----399","3.95    0.00    3.99",{"depth":166,"slug":272,"text":273},"--parallelized","# # parallelized",{"depth":170,"slug":275,"text":267},"user--system-elapsed-1",{"depth":170,"slug":277,"text":278},"003----000----304","0.03    0.00    3.04",{"depth":166,"slug":280,"text":281},"--how-many-paramter-settings-did-we-have","# # how many paramter settings did we have?",{"depth":170,"slug":283,"text":284},"1-36","[1] 36",{"depth":166,"slug":286,"text":287},"--what-was-the-accuracy-distribution","# # what was the accuracy distribution?",{"depth":166,"slug":289,"text":290},"--what-parameter-setting-had-the-best-performance","# # what parameter setting had the best performance?",{"depth":170,"slug":292,"text":293},"beta_val-learning_rate-num_hids","beta_val learning_rate num_hids",{"depth":170,"slug":295,"text":296},"33--------0----------015--------6","33        0          0.15        6",{"depth":166,"slug":298,"text":299},"--what-parameter-setting-had-the-worst-perfomance","# # what parameter setting had the worst perfomance?",{"depth":170,"slug":301,"text":293},"beta_val-learning_rate-num_hids-1",{"depth":170,"slug":303,"text":304},"7--------2-----------01--------4","7        2           0.1        4",{"depth":166,"slug":306,"text":307},"--plot-em","# # plot em",{"depth":166,"slug":309,"text":310},"--what-comes-as-output-for-each-parameter-setting","# # what comes as output for each parameter setting?",{"depth":170,"slug":312,"text":313},"1-resp_probs-params-----st","[1] “resp_probs” “params”     “st”",{"depth":166,"slug":315,"text":316},"--plot-the-training-curves-for-a-parameter-subset-hid-units--5","# # plot the training curves for a parameter subset (hid units = 5)",{"depth":166,"slug":318,"text":319},"--how-many","# # how many?",{"depth":170,"slug":321,"text":322},"1-12","[1] 12",{"depth":166,"slug":324,"text":325},"--accuracy","# # accuracy?",[],[],{"title":224,"excerpt":225,"tags":226,"season":227,"type":9,"layout":40},[],"2017-7-30-catlearn-grid-search.md","2017-6-28-catlearn-suppls-demo",{"id":331,"data":333,"body":337,"filePath":338,"digest":339,"rendered":340,"legacyId":475},{"title":334,"excerpt":335,"tags":336,"season":227,"type":9,"layout":40},"Getting Started with Catlearn and Catlearn Supplementals","Brief introduction to machine learning and cognitive modeling with Catlearn and Catlearn Supplementals","machine learning, cognitive modeling, catlearn","# background\n\nThis post is intended to help people get started with their own cognitive modelling or machine learning projects in the `catlearn` environment with the help of `catlearn.suppls`, the [Learning and Representation in Cognition Laboratory](http://kurtzlab.psychology.binghamton.edu/)'s suite of helper functions for modeling in `catlearn`.\n\nThe motivation behind `catlearn.suppls` was to create a suite of functions that could be used to rapidly prototype new machine learning architectures that correspond to the cognitive modeling efforts of the LaRC Lab. This includes functions to set up the *state* information of a model and quickly take rectangular data and format it for the `catlearn` design pattern---the stateful list processor.\n\n# getting Started\n\nIf you haven't already done so, download the `catlearn` and `catlearn.suppls` packages.\n\n\n{% highlight r %}\ninstall.packages(c(\"devtools\", \"catlearn\"))\ndevtools::install_github(\"ghonk/catlearn.suppls\")\n{% endhighlight %}\n\n# choosing some data and setting up the model\n\nWe're going to use the classic `iris` dataset and DIVA (the DIVergent Autoencoder) for this demonstration. We need two objects to run a model in `catlearn`, the model's `state` and the training matrix, which we will call `tr`.\n\n\n{% highlight r %}\n# # # load the libraries\nlibrary(catlearn)\nlibrary(catlearn.suppls)\n{% endhighlight %}\n\n*First, we will construct the model's state.* For this demonstration we'll set the hyper-parameters to values that we know---a priori---will play nice with our dataset. For real-world problems, you will likely want optimize these values (see future post on grid search and Bayesian optimization options with `catlearn.suppls`). Detailed description of model hyper-parameters is available in the normal places (e.g., `?slpDIVA`).\n\n\n{% highlight r %}\n# # # setup the inputs, class labels and model state\n# check out our data\nstr(iris)\n{% endhighlight %}\n\n\n\n{% highlight text %}\n## 'data.frame':\t150 obs. of  5 variables:\n##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n##  $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n{% endhighlight %}\n\n\n\n{% highlight r %}\n# find the inputs minus the labels\nins \u003C- iris[,colnames(iris) != 'Species']\n\n# create a separate vector for the labels (labels must be numeric)\nlabs \u003C- as.numeric(iris[,'Species'])\n\n# get number of categories and features\nnfeats \u003C- dim(ins)[2]\nncats \u003C- length(unique(labs))\n\n# construct a state list\nst \u003C- list(learning_rate = 0.15, num_feats = nfeats, num_hids = 6, num_cats = ncats,\n  beta_val = 0, phi = 1, continuous = TRUE, in_wts = NULL, out_wts = NULL, wts_range = 1,\n  wts_center = 0, colskip = 4)\n{% endhighlight %}\n\nWe can then use `catleanr.suppls` to create our training matrix\n\n\n{% highlight r %}\n# tr_init initializes an empty training matrix\ntr \u003C- tr_init(nfeats, ncats)\n\n# tr_add fills in the data and procedure (i.e., training, test, model reset)\ntr \u003C- tr_add(inputs = ins, tr = tr, labels = labs, blocks = 12, ctrl = 0, \n  shuffle = TRUE, reset = TRUE)\n{% endhighlight %}\n\nHere's what our training matrix looks like after the setup procedure:\n\n{% highlight r %}\nhead(tr)\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##      ctrl trial blk example  x1  x2  x3  x4 t1 t2 t3\n## [1,]    1     1   1     118 7.7 3.8 6.7 2.2 -1 -1  1\n## [2,]    0     2   1      64 6.1 2.9 4.7 1.4 -1  1 -1\n## [3,]    0     3   1      23 4.6 3.6 1.0 0.2  1 -1 -1\n## [4,]    0     4   1      87 6.7 3.1 4.7 1.5 -1  1 -1\n## [5,]    0     5   1      99 5.1 2.5 3.0 1.1 -1  1 -1\n## [6,]    0     6   1      92 6.1 3.0 4.6 1.4 -1  1 -1\n{% endhighlight %}\n\nFinally, we run the model with our state list `st` and training matrix `tr`\n\n\n{% highlight r %}\ndiva_model \u003C- slpDIVA(st, tr)\n{% endhighlight %}\n\nWe can examine performance of the model easily. \n\n\n{% highlight r %}\n# # # use response_probs to extract the response probabilities \n# # # for the target categories (for every training step (trial) \n# # # or averaged across blocks)\n\nresponse_probs(tr, diva_model$out, blocks = TRUE)\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##  [1] 0.7852448 0.8431547 0.8103888 0.8067568 0.8087171 0.8102305 0.8135465\n##  [8] 0.8028162 0.8466575 0.8375568 0.8025279 0.8350697\n{% endhighlight %}\n\n`plot_training` is a simple function used to plot the learning of one or more models.\n\n\n{% highlight r %}\nplot_training(list(response_probs(tr, diva_model$out, blocks = TRUE)))\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-9](/assets/rfigs/unnamed-chunk-9-1.svg)\n\nSo with no optimization, we can see that DIVA learns about as much as it is going to learn after one pass through our 150 item training set (obviously absent any cross-validation). Where does it go wrong? You might like to examine which items are not being correctly classified---you can do so by combining the classification probabilities with the original training matrix.\n\n\n{% highlight r %}\n# # # if we want to look at individual classication decisions, \n# # # we can do so by combining the model's output with the \n# # # original training matrix\n\ntrn_result \u003C- cbind(tr, round(diva_model$out, 4))\ntail(trn_result)\n{% endhighlight %}\n\n\n\n{% highlight text %}\n##         ctrl trial blk example  x1  x2  x3  x4 t1 t2 t3                     \n## [1795,]    0  1795  12     123 7.7 2.8 6.7 2.0 -1 -1  1 0.0005 0.0006 0.9989\n## [1796,]    0  1796  12      82 5.5 2.4 3.7 1.0 -1  1 -1 0.0000 0.9999 0.0000\n## [1797,]    0  1797  12     125 6.7 3.3 5.7 2.1 -1 -1  1 0.1204 0.1765 0.7030\n## [1798,]    0  1798  12       1 5.1 3.5 1.4 0.2  1 -1 -1 1.0000 0.0000 0.0000\n## [1799,]    0  1799  12     144 6.8 3.2 5.9 2.3 -1 -1  1 0.0000 0.0000 1.0000\n## [1800,]    0  1800  12     129 6.4 2.8 5.6 2.1 -1 -1  1 0.0001 0.0002 0.9996\n{% endhighlight %}\n\nYou might also like to see how a number of initializations do on the problem. It's good practice to average over a series of initializations---something we did not do in this demonstration.\n\n\n{% highlight r %}\n# # # Run 5 models with the same params on the same training set\nmodel_inits \u003C- lapply(1:5, function(x) slpDIVA(st, tr))\n\n# # # determine the response probability for the correct class\nmodel_resp_probs \u003C- \n  lapply(model_inits, function(x) {\n    response_probs(tr, x$out, blocks = TRUE)})\n\n# # # plot the leanrning curves\nplot_training(model_resp_probs)\n{% endhighlight %}\n\n![plot of chunk unnamed-chunk-11](/assets/rfigs/unnamed-chunk-11-1.svg)\n\nHere we see that there is a fair amount of variation across initializations. This suggests it would be smart to follow the typical procedure of averaging across a series of models to accurately represent the response probabilities. It also suggests that our approach would likely benefit from some optimization and validation. \n\n\nFuture demos will explore the tools within `catlearn.suppls` used to optimize hyper-parameters and examine the hidden unit representation space toward the goal of uncovering new insight about the problem.","src/content/blog/2017-6-28-catlearn-suppls-demo.md","a508bfb00130bb95",{"html":341,"metadata":342},"\u003Ch1 id=\"background\">background\u003C/h1>\n\u003Cp>This post is intended to help people get started with their own cognitive modelling or machine learning projects in the \u003Ccode>catlearn\u003C/code> environment with the help of \u003Ccode>catlearn.suppls\u003C/code>, the \u003Ca href=\"http://kurtzlab.psychology.binghamton.edu/\">Learning and Representation in Cognition Laboratory\u003C/a>’s suite of helper functions for modeling in \u003Ccode>catlearn\u003C/code>.\u003C/p>\n\u003Cp>The motivation behind \u003Ccode>catlearn.suppls\u003C/code> was to create a suite of functions that could be used to rapidly prototype new machine learning architectures that correspond to the cognitive modeling efforts of the LaRC Lab. This includes functions to set up the \u003Cem>state\u003C/em> information of a model and quickly take rectangular data and format it for the \u003Ccode>catlearn\u003C/code> design pattern---the stateful list processor.\u003C/p>\n\u003Ch1 id=\"getting-started\">getting Started\u003C/h1>\n\u003Cp>If you haven’t already done so, download the \u003Ccode>catlearn\u003C/code> and \u003Ccode>catlearn.suppls\u003C/code> packages.\u003C/p>\n\u003Cp>{% highlight r %}\ninstall.packages(c(“devtools”, “catlearn”))\ndevtools::install_github(“ghonk/catlearn.suppls”)\n{% endhighlight %}\u003C/p>\n\u003Ch1 id=\"choosing-some-data-and-setting-up-the-model\">choosing some data and setting up the model\u003C/h1>\n\u003Cp>We’re going to use the classic \u003Ccode>iris\u003C/code> dataset and DIVA (the DIVergent Autoencoder) for this demonstration. We need two objects to run a model in \u003Ccode>catlearn\u003C/code>, the model’s \u003Ccode>state\u003C/code> and the training matrix, which we will call \u003Ccode>tr\u003C/code>.\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--load-the-libraries\"># # load the libraries\u003C/h1>\n\u003Cp>library(catlearn)\nlibrary(catlearn.suppls)\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cem>First, we will construct the model’s state.\u003C/em> For this demonstration we’ll set the hyper-parameters to values that we know---a priori---will play nice with our dataset. For real-world problems, you will likely want optimize these values (see future post on grid search and Bayesian optimization options with \u003Ccode>catlearn.suppls\u003C/code>). Detailed description of model hyper-parameters is available in the normal places (e.g., \u003Ccode>?slpDIVA\u003C/code>).\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--setup-the-inputs-class-labels-and-model-state\"># # setup the inputs, class labels and model state\u003C/h1>\n\u003Ch1 id=\"check-out-our-data\">check out our data\u003C/h1>\n\u003Cp>str(iris)\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"dataframe150-obs-of--5-variables\">‘data.frame’:\t150 obs. of  5 variables:\u003C/h2>\n\u003Ch2 id=\"-sepallength-num--51-49-47-46-5-54-46-5-44-49\">$ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 …\u003C/h2>\n\u003Ch2 id=\"-sepalwidth--num--35-3-32-31-36-39-34-34-29-31\">$ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 …\u003C/h2>\n\u003Ch2 id=\"-petallength-num--14-14-13-15-14-17-14-15-14-15\">$ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 …\u003C/h2>\n\u003Ch2 id=\"-petalwidth--num--02-02-02-02-02-04-03-02-02-01\">$ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 …\u003C/h2>\n\u003Ch2 id=\"-species------factor-w-3-levels-setosaversicolor-1-1-1-1-1-1-1-1-1-1\">$ Species     : Factor w/ 3 levels “setosa”,“versicolor”,..: 1 1 1 1 1 1 1 1 1 1 …\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"find-the-inputs-minus-the-labels\">find the inputs minus the labels\u003C/h1>\n\u003Cp>ins &#x3C;- iris[,colnames(iris) != ‘Species’]\u003C/p>\n\u003Ch1 id=\"create-a-separate-vector-for-the-labels-labels-must-be-numeric\">create a separate vector for the labels (labels must be numeric)\u003C/h1>\n\u003Cp>labs &#x3C;- as.numeric(iris[,‘Species’])\u003C/p>\n\u003Ch1 id=\"get-number-of-categories-and-features\">get number of categories and features\u003C/h1>\n\u003Cp>nfeats &#x3C;- dim(ins)[2]\nncats &#x3C;- length(unique(labs))\u003C/p>\n\u003Ch1 id=\"construct-a-state-list\">construct a state list\u003C/h1>\n\u003Cp>st &#x3C;- list(learning_rate = 0.15, num_feats = nfeats, num_hids = 6, num_cats = ncats,\nbeta_val = 0, phi = 1, continuous = TRUE, in_wts = NULL, out_wts = NULL, wts_range = 1,\nwts_center = 0, colskip = 4)\n{% endhighlight %}\u003C/p>\n\u003Cp>We can then use \u003Ccode>catleanr.suppls\u003C/code> to create our training matrix\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"tr_init-initializes-an-empty-training-matrix\">tr_init initializes an empty training matrix\u003C/h1>\n\u003Cp>tr &#x3C;- tr_init(nfeats, ncats)\u003C/p>\n\u003Ch1 id=\"tr_add-fills-in-the-data-and-procedure-ie-training-test-model-reset\">tr_add fills in the data and procedure (i.e., training, test, model reset)\u003C/h1>\n\u003Cp>tr &#x3C;- tr_add(inputs = ins, tr = tr, labels = labs, blocks = 12, ctrl = 0,\nshuffle = TRUE, reset = TRUE)\n{% endhighlight %}\u003C/p>\n\u003Cp>Here’s what our training matrix looks like after the setup procedure:\u003C/p>\n\u003Cp>{% highlight r %}\nhead(tr)\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"ctrl-trial-blk-example--x1--x2--x3--x4-t1-t2-t3\">ctrl trial blk example  x1  x2  x3  x4 t1 t2 t3\u003C/h2>\n\u003Ch2 id=\"1----1-----1---1-----118-77-38-67-22--1--1--1\">[1,]    1     1   1     118 7.7 3.8 6.7 2.2 -1 -1  1\u003C/h2>\n\u003Ch2 id=\"2----0-----2---1------64-61-29-47-14--1--1--1\">[2,]    0     2   1      64 6.1 2.9 4.7 1.4 -1  1 -1\u003C/h2>\n\u003Ch2 id=\"3----0-----3---1------23-46-36-10-02--1--1--1\">[3,]    0     3   1      23 4.6 3.6 1.0 0.2  1 -1 -1\u003C/h2>\n\u003Ch2 id=\"4----0-----4---1------87-67-31-47-15--1--1--1\">[4,]    0     4   1      87 6.7 3.1 4.7 1.5 -1  1 -1\u003C/h2>\n\u003Ch2 id=\"5----0-----5---1------99-51-25-30-11--1--1--1\">[5,]    0     5   1      99 5.1 2.5 3.0 1.1 -1  1 -1\u003C/h2>\n\u003Ch2 id=\"6----0-----6---1------92-61-30-46-14--1--1--1\">[6,]    0     6   1      92 6.1 3.0 4.6 1.4 -1  1 -1\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>Finally, we run the model with our state list \u003Ccode>st\u003C/code> and training matrix \u003Ccode>tr\u003C/code>\u003C/p>\n\u003Cp>{% highlight r %}\ndiva_model &#x3C;- slpDIVA(st, tr)\n{% endhighlight %}\u003C/p>\n\u003Cp>We can examine performance of the model easily.\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--use-response_probs-to-extract-the-response-probabilities\"># # use response_probs to extract the response probabilities\u003C/h1>\n\u003Ch1 id=\"--for-the-target-categories-for-every-training-step-trial\"># # for the target categories (for every training step (trial)\u003C/h1>\n\u003Ch1 id=\"--or-averaged-across-blocks\"># # or averaged across blocks)\u003C/h1>\n\u003Cp>response_probs(tr, diva_model$out, blocks = TRUE)\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"1-07852448-08431547-08103888-08067568-08087171-08102305-08135465\">[1] 0.7852448 0.8431547 0.8103888 0.8067568 0.8087171 0.8102305 0.8135465\u003C/h2>\n\u003Ch2 id=\"8-08028162-08466575-08375568-08025279-08350697\">[8] 0.8028162 0.8466575 0.8375568 0.8025279 0.8350697\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>\u003Ccode>plot_training\u003C/code> is a simple function used to plot the learning of one or more models.\u003C/p>\n\u003Cp>{% highlight r %}\nplot_training(list(response_probs(tr, diva_model$out, blocks = TRUE)))\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-9-1.svg\" alt=\"plot of chunk unnamed-chunk-9\">\u003C/p>\n\u003Cp>So with no optimization, we can see that DIVA learns about as much as it is going to learn after one pass through our 150 item training set (obviously absent any cross-validation). Where does it go wrong? You might like to examine which items are not being correctly classified---you can do so by combining the classification probabilities with the original training matrix.\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--if-we-want-to-look-at-individual-classication-decisions\"># # if we want to look at individual classication decisions,\u003C/h1>\n\u003Ch1 id=\"--we-can-do-so-by-combining-the-models-output-with-the\"># # we can do so by combining the model’s output with the\u003C/h1>\n\u003Ch1 id=\"--original-training-matrix\"># # original training matrix\u003C/h1>\n\u003Cp>trn_result &#x3C;- cbind(tr, round(diva_model$out, 4))\ntail(trn_result)\n{% endhighlight %}\u003C/p>\n\u003Cp>{% highlight text %}\u003C/p>\n\u003Ch2 id=\"ctrl-trial-blk-example--x1--x2--x3--x4-t1-t2-t3-1\">ctrl trial blk example  x1  x2  x3  x4 t1 t2 t3\u003C/h2>\n\u003Ch2 id=\"1795----0--1795--12-----123-77-28-67-20--1--1--1-00005-00006-09989\">[1795,]    0  1795  12     123 7.7 2.8 6.7 2.0 -1 -1  1 0.0005 0.0006 0.9989\u003C/h2>\n\u003Ch2 id=\"1796----0--1796--12------82-55-24-37-10--1--1--1-00000-09999-00000\">[1796,]    0  1796  12      82 5.5 2.4 3.7 1.0 -1  1 -1 0.0000 0.9999 0.0000\u003C/h2>\n\u003Ch2 id=\"1797----0--1797--12-----125-67-33-57-21--1--1--1-01204-01765-07030\">[1797,]    0  1797  12     125 6.7 3.3 5.7 2.1 -1 -1  1 0.1204 0.1765 0.7030\u003C/h2>\n\u003Ch2 id=\"1798----0--1798--12-------1-51-35-14-02--1--1--1-10000-00000-00000\">[1798,]    0  1798  12       1 5.1 3.5 1.4 0.2  1 -1 -1 1.0000 0.0000 0.0000\u003C/h2>\n\u003Ch2 id=\"1799----0--1799--12-----144-68-32-59-23--1--1--1-00000-00000-10000\">[1799,]    0  1799  12     144 6.8 3.2 5.9 2.3 -1 -1  1 0.0000 0.0000 1.0000\u003C/h2>\n\u003Ch2 id=\"1800----0--1800--12-----129-64-28-56-21--1--1--1-00001-00002-09996\">[1800,]    0  1800  12     129 6.4 2.8 5.6 2.1 -1 -1  1 0.0001 0.0002 0.9996\u003C/h2>\n\u003Cp>{% endhighlight %}\u003C/p>\n\u003Cp>You might also like to see how a number of initializations do on the problem. It’s good practice to average over a series of initializations---something we did not do in this demonstration.\u003C/p>\n\u003Cp>{% highlight r %}\u003C/p>\n\u003Ch1 id=\"--run-5-models-with-the-same-params-on-the-same-training-set\"># # Run 5 models with the same params on the same training set\u003C/h1>\n\u003Cp>model_inits &#x3C;- lapply(1:5, function(x) slpDIVA(st, tr))\u003C/p>\n\u003Ch1 id=\"--determine-the-response-probability-for-the-correct-class\"># # determine the response probability for the correct class\u003C/h1>\n\u003Cp>model_resp_probs &#x3C;-\nlapply(model_inits, function(x) {\nresponse_probs(tr, x$out, blocks = TRUE)})\u003C/p>\n\u003Ch1 id=\"--plot-the-leanrning-curves\"># # plot the leanrning curves\u003C/h1>\n\u003Cp>plot_training(model_resp_probs)\n{% endhighlight %}\u003C/p>\n\u003Cp>\u003Cimg src=\"/assets/rfigs/unnamed-chunk-11-1.svg\" alt=\"plot of chunk unnamed-chunk-11\">\u003C/p>\n\u003Cp>Here we see that there is a fair amount of variation across initializations. This suggests it would be smart to follow the typical procedure of averaging across a series of models to accurately represent the response probabilities. It also suggests that our approach would likely benefit from some optimization and validation.\u003C/p>\n\u003Cp>Future demos will explore the tools within \u003Ccode>catlearn.suppls\u003C/code> used to optimize hyper-parameters and examine the hidden unit representation space toward the goal of uncovering new insight about the problem.\u003C/p>",{"headings":343,"localImagePaths":471,"remoteImagePaths":472,"frontmatter":473,"imagePaths":474},[344,346,349,352,355,358,361,364,367,370,373,376,379,382,385,388,391,394,397,400,403,406,409,412,415,418,421,424,427,430,433,436,439,442,444,447,450,453,456,459,462,465,468],{"depth":166,"slug":345,"text":345},"background",{"depth":166,"slug":347,"text":348},"getting-started","getting Started",{"depth":166,"slug":350,"text":351},"choosing-some-data-and-setting-up-the-model","choosing some data and setting up the model",{"depth":166,"slug":353,"text":354},"--load-the-libraries","# # load the libraries",{"depth":166,"slug":356,"text":357},"--setup-the-inputs-class-labels-and-model-state","# # setup the inputs, class labels and model state",{"depth":166,"slug":359,"text":360},"check-out-our-data","check out our data",{"depth":170,"slug":362,"text":363},"dataframe150-obs-of--5-variables","‘data.frame’:\t150 obs. of  5 variables:",{"depth":170,"slug":365,"text":366},"-sepallength-num--51-49-47-46-5-54-46-5-44-49","$ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 …",{"depth":170,"slug":368,"text":369},"-sepalwidth--num--35-3-32-31-36-39-34-34-29-31","$ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 …",{"depth":170,"slug":371,"text":372},"-petallength-num--14-14-13-15-14-17-14-15-14-15","$ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 …",{"depth":170,"slug":374,"text":375},"-petalwidth--num--02-02-02-02-02-04-03-02-02-01","$ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 …",{"depth":170,"slug":377,"text":378},"-species------factor-w-3-levels-setosaversicolor-1-1-1-1-1-1-1-1-1-1","$ Species     : Factor w/ 3 levels “setosa”,“versicolor”,..: 1 1 1 1 1 1 1 1 1 1 …",{"depth":166,"slug":380,"text":381},"find-the-inputs-minus-the-labels","find the inputs minus the labels",{"depth":166,"slug":383,"text":384},"create-a-separate-vector-for-the-labels-labels-must-be-numeric","create a separate vector for the labels (labels must be numeric)",{"depth":166,"slug":386,"text":387},"get-number-of-categories-and-features","get number of categories and features",{"depth":166,"slug":389,"text":390},"construct-a-state-list","construct a state list",{"depth":166,"slug":392,"text":393},"tr_init-initializes-an-empty-training-matrix","tr_init initializes an empty training matrix",{"depth":166,"slug":395,"text":396},"tr_add-fills-in-the-data-and-procedure-ie-training-test-model-reset","tr_add fills in the data and procedure (i.e., training, test, model reset)",{"depth":170,"slug":398,"text":399},"ctrl-trial-blk-example--x1--x2--x3--x4-t1-t2-t3","ctrl trial blk example  x1  x2  x3  x4 t1 t2 t3",{"depth":170,"slug":401,"text":402},"1----1-----1---1-----118-77-38-67-22--1--1--1","[1,]    1     1   1     118 7.7 3.8 6.7 2.2 -1 -1  1",{"depth":170,"slug":404,"text":405},"2----0-----2---1------64-61-29-47-14--1--1--1","[2,]    0     2   1      64 6.1 2.9 4.7 1.4 -1  1 -1",{"depth":170,"slug":407,"text":408},"3----0-----3---1------23-46-36-10-02--1--1--1","[3,]    0     3   1      23 4.6 3.6 1.0 0.2  1 -1 -1",{"depth":170,"slug":410,"text":411},"4----0-----4---1------87-67-31-47-15--1--1--1","[4,]    0     4   1      87 6.7 3.1 4.7 1.5 -1  1 -1",{"depth":170,"slug":413,"text":414},"5----0-----5---1------99-51-25-30-11--1--1--1","[5,]    0     5   1      99 5.1 2.5 3.0 1.1 -1  1 -1",{"depth":170,"slug":416,"text":417},"6----0-----6---1------92-61-30-46-14--1--1--1","[6,]    0     6   1      92 6.1 3.0 4.6 1.4 -1  1 -1",{"depth":166,"slug":419,"text":420},"--use-response_probs-to-extract-the-response-probabilities","# # use response_probs to extract the response probabilities",{"depth":166,"slug":422,"text":423},"--for-the-target-categories-for-every-training-step-trial","# # for the target categories (for every training step (trial)",{"depth":166,"slug":425,"text":426},"--or-averaged-across-blocks","# # or averaged across blocks)",{"depth":170,"slug":428,"text":429},"1-07852448-08431547-08103888-08067568-08087171-08102305-08135465","[1] 0.7852448 0.8431547 0.8103888 0.8067568 0.8087171 0.8102305 0.8135465",{"depth":170,"slug":431,"text":432},"8-08028162-08466575-08375568-08025279-08350697","[8] 0.8028162 0.8466575 0.8375568 0.8025279 0.8350697",{"depth":166,"slug":434,"text":435},"--if-we-want-to-look-at-individual-classication-decisions","# # if we want to look at individual classication decisions,",{"depth":166,"slug":437,"text":438},"--we-can-do-so-by-combining-the-models-output-with-the","# # we can do so by combining the model’s output with the",{"depth":166,"slug":440,"text":441},"--original-training-matrix","# # original training matrix",{"depth":170,"slug":443,"text":399},"ctrl-trial-blk-example--x1--x2--x3--x4-t1-t2-t3-1",{"depth":170,"slug":445,"text":446},"1795----0--1795--12-----123-77-28-67-20--1--1--1-00005-00006-09989","[1795,]    0  1795  12     123 7.7 2.8 6.7 2.0 -1 -1  1 0.0005 0.0006 0.9989",{"depth":170,"slug":448,"text":449},"1796----0--1796--12------82-55-24-37-10--1--1--1-00000-09999-00000","[1796,]    0  1796  12      82 5.5 2.4 3.7 1.0 -1  1 -1 0.0000 0.9999 0.0000",{"depth":170,"slug":451,"text":452},"1797----0--1797--12-----125-67-33-57-21--1--1--1-01204-01765-07030","[1797,]    0  1797  12     125 6.7 3.3 5.7 2.1 -1 -1  1 0.1204 0.1765 0.7030",{"depth":170,"slug":454,"text":455},"1798----0--1798--12-------1-51-35-14-02--1--1--1-10000-00000-00000","[1798,]    0  1798  12       1 5.1 3.5 1.4 0.2  1 -1 -1 1.0000 0.0000 0.0000",{"depth":170,"slug":457,"text":458},"1799----0--1799--12-----144-68-32-59-23--1--1--1-00000-00000-10000","[1799,]    0  1799  12     144 6.8 3.2 5.9 2.3 -1 -1  1 0.0000 0.0000 1.0000",{"depth":170,"slug":460,"text":461},"1800----0--1800--12-----129-64-28-56-21--1--1--1-00001-00002-09996","[1800,]    0  1800  12     129 6.4 2.8 5.6 2.1 -1 -1  1 0.0001 0.0002 0.9996",{"depth":166,"slug":463,"text":464},"--run-5-models-with-the-same-params-on-the-same-training-set","# # Run 5 models with the same params on the same training set",{"depth":166,"slug":466,"text":467},"--determine-the-response-probability-for-the-correct-class","# # determine the response probability for the correct class",{"depth":166,"slug":469,"text":470},"--plot-the-leanrning-curves","# # plot the leanrning curves",[],[],{"title":334,"excerpt":335,"tags":336,"season":227,"type":9,"layout":40},[],"2017-6-28-catlearn-suppls-demo.md","2018-3-23-croc",{"id":476,"data":478,"filePath":484,"digest":485,"rendered":486,"legacyId":493},{"title":479,"excerpt":480,"tags":481,"season":482,"assets":18,"type":114,"external_url":483,"layout":21},"CROC (Character Recognition and Object Classification) Image Analysis System","Published an open-source PIP-installable library that performs object recognition and OCR","python, neural network, machine learning","spring 2018","https://github.com/NewKnowledge/nk_croc","src/content/blog/2018-3-23-croc.md","1ab63f2fc36df430",{"html":25,"metadata":487},{"headings":488,"localImagePaths":489,"remoteImagePaths":490,"frontmatter":491,"imagePaths":492},[],[],[],{"title":479,"excerpt":480,"tags":481,"season":482,"assets":18,"type":114,"external_url":483,"layout":21},[],"2018-3-23-croc.md","2017-9-1-catcon-preprint",{"id":494,"data":496,"body":501,"filePath":502,"digest":503,"rendered":504,"legacyId":512},{"title":497,"excerpt":498,"tags":499,"season":59,"assets":18,"type":19,"external_url":500,"layout":21},"Preprint - Category Construction Promotes Transfer","Submitted the first preprint from the LaRC Lab - Category Construction Promotes Transfer","transfer, cognition, paper","/pdfs/manuscripts/kurtz-and-honke-psyarxiv-catcon.pdf","Yay open science","src/content/blog/2017-9-1-catcon-preprint.md","527c0e7104de97c2",{"html":505,"metadata":506},"\u003Cp>Yay open science\u003C/p>",{"headings":507,"localImagePaths":508,"remoteImagePaths":509,"frontmatter":510,"imagePaths":511},[],[],[],{"title":497,"excerpt":498,"tags":499,"season":59,"assets":18,"type":19,"external_url":500,"layout":21},[],"2017-9-1-catcon-preprint.md","2018-4-13-relational-categories-symposium18",{"id":513,"data":515,"filePath":520,"digest":521,"rendered":522,"legacyId":529},{"title":516,"excerpt":517,"tags":518,"season":482,"assets":18,"type":19,"external_url":519,"layout":21},"Relational Categories: Why they're Important and How they are Learned","Symposium on relational category learning accepted at CogSci 2018","relational knowledge, cognition, paper, category","/pdfs/manuscripts/gentner_2_1.pdf","src/content/blog/2018-4-13-relational-categories-symposium18.md","06a622373555a373",{"html":25,"metadata":523},{"headings":524,"localImagePaths":525,"remoteImagePaths":526,"frontmatter":527,"imagePaths":528},[],[],[],{"title":516,"excerpt":517,"tags":518,"season":482,"assets":18,"type":19,"external_url":519,"layout":21},[],"2018-4-13-relational-categories-symposium18.md","2018-4-23-ape",{"id":530,"data":532,"filePath":537,"digest":538,"rendered":539,"legacyId":546},{"title":533,"excerpt":534,"tags":535,"season":482,"assets":18,"type":114,"external_url":536,"layout":21},"APE - Abstractive Prediction via [knowledge] Embedding","Colleagues and I published APE (Abstractive Prediction via Embedding), an open-source PIP-installable library that predicts more abstract labels (i.e. higher-order category membership) for a provided set of concepts","python, categories, machine learning","https://github.com/NewKnowledge/nk_ape","src/content/blog/2018-4-23-ape.md","07b9ce8b39927ed6",{"html":25,"metadata":540},{"headings":541,"localImagePaths":542,"remoteImagePaths":543,"frontmatter":544,"imagePaths":545},[],[],[],{"title":533,"excerpt":534,"tags":535,"season":482,"assets":18,"type":114,"external_url":536,"layout":21},[],"2018-4-23-ape.md","2018-6-16-duke_automl18",{"id":547,"data":549,"filePath":555,"digest":556,"rendered":557,"legacyId":564},{"title":550,"excerpt":551,"tags":552,"season":553,"assets":18,"type":19,"external_url":554,"layout":21},"Abstractive Tabular Dataset Summarization via Knowledge Base Semantic Embeddings","Paper on automatic dataset topic summarization accepted for presentation at the ICML '18 AutoML workshop","machine learning, paper","summer 2018","/pdfs/manuscripts/azunre_et_al_2018.pdf","src/content/blog/2018-6-16-duke_automl18.md","2c7f902496b46be1",{"html":25,"metadata":558},{"headings":559,"localImagePaths":560,"remoteImagePaths":561,"frontmatter":562,"imagePaths":563},[],[],[],{"title":550,"excerpt":551,"tags":552,"season":553,"assets":18,"type":19,"external_url":554,"layout":21},[],"2018-6-16-duke_automl18.md","2018-6-23-unicorn",{"id":565,"data":567,"filePath":572,"digest":573,"rendered":574,"legacyId":581},{"title":568,"excerpt":569,"tags":570,"season":553,"assets":18,"type":114,"external_url":571,"layout":21},"UNICORN - UNsupervised Image Clustering with Object Recognition Network","Published UNICORN (UNsupervised Image Clustering with Object Recognition Network), a python library that classifies images based on their similarity with respect to the activation pattern produced by the Inception V3 network trained on Imagenet.","python, image analysis, machine learning","https://github.com/NewKnowledge/nk_unicorn","src/content/blog/2018-6-23-unicorn.md","da46718fa2741962",{"html":25,"metadata":575},{"headings":576,"localImagePaths":577,"remoteImagePaths":578,"frontmatter":579,"imagePaths":580},[],[],[],{"title":568,"excerpt":569,"tags":570,"season":553,"assets":18,"type":114,"external_url":571,"layout":21},[],"2018-6-23-unicorn.md","2018-6-24-ibex",{"id":582,"data":584,"filePath":589,"digest":590,"rendered":591,"legacyId":598},{"title":585,"excerpt":586,"tags":587,"season":553,"assets":18,"type":114,"external_url":588,"layout":21},"IBEX - Intelligence-Based Entity Xtraction","Colleagues and I (mostly them!) have open-sourced IBEX, a topic extraction library in python","python, topic extraction, machine learning","https://github.com/NewKnowledge/ibex","src/content/blog/2018-6-24-ibex.md","cf8c8c7ab738f31d",{"html":25,"metadata":592},{"headings":593,"localImagePaths":594,"remoteImagePaths":595,"frontmatter":596,"imagePaths":597},[],[],[],{"title":585,"excerpt":586,"tags":587,"season":553,"assets":18,"type":114,"external_url":588,"layout":21},[],"2018-6-24-ibex.md","2018-6-26-honke_and_kurtz_18",{"id":599,"data":601,"filePath":606,"digest":607,"rendered":608,"legacyId":615},{"title":602,"excerpt":603,"tags":604,"season":553,"assets":18,"type":19,"external_url":605,"layout":21},"Similarity is as Similarity Does? A Critical Inquiry into the Effect of Thematic Association on Similarity","The first behavioral work from my dissertation is under review (preprint at PsyArXiv) wherein we discovered a surprising inconsistency in human similarity judgements across the timecourse of a single experimental session","similarity, cognition, paper","/pdfs/manuscripts/honke-and-kurtz-2018.pdf","src/content/blog/2018-6-26-honke_and_kurtz_18.md","c5a395b29f891960",{"html":25,"metadata":609},{"headings":610,"localImagePaths":611,"remoteImagePaths":612,"frontmatter":613,"imagePaths":614},[],[],[],{"title":602,"excerpt":603,"tags":604,"season":553,"assets":18,"type":19,"external_url":605,"layout":21},[],"2018-6-26-honke_and_kurtz_18.md","2018-9-04-category_conflict",{"id":616,"data":618,"filePath":624,"digest":625,"rendered":626,"legacyId":633},{"title":619,"excerpt":620,"tags":621,"season":622,"assets":18,"type":19,"external_url":623,"layout":21},"Categories in Conflict: Combating the application of an intuitive conception of inheritance with category construction.","Paper published at the Journal of Research in Science Teaching - category construction in the classroom as a technique to reduce the use of scientifically-invalid (i.e., intuitive) beliefs about inheritance","transfer, cognition, learning, paper","fall 2018","/pdfs/manuscripts/premo-et-al-2018.pdf","src/content/blog/2018-9-04-category_conflict.md","7cf311c7b67cf8fa",{"html":25,"metadata":627},{"headings":628,"localImagePaths":629,"remoteImagePaths":630,"frontmatter":631,"imagePaths":632},[],[],[],{"title":619,"excerpt":620,"tags":621,"season":622,"assets":18,"type":19,"external_url":623,"layout":21},[],"2018-9-04-category_conflict.md","2019-04-20-ocr-on-gov-docs",{"id":634,"data":636,"filePath":642,"digest":643,"rendered":644,"legacyId":651},{"title":637,"excerpt":638,"tags":639,"season":640,"assets":18,"type":9,"external_url":641,"layout":21},"A short thread on efforts to re-digitize the un-digitized","Short thread with resources on digitization, government records, and publishing decisions of the Mueller Report by the U.S. DOJ","incarceration trends, campaign finance, OCR, code","spring 2019","https://twitter.com/garretthonke/status/1119623619146125314","src/content/blog/2019-04-20-ocr-on-gov-docs.md","dba5986901468a12",{"html":25,"metadata":645},{"headings":646,"localImagePaths":647,"remoteImagePaths":648,"frontmatter":649,"imagePaths":650},[],[],[],{"title":637,"excerpt":638,"tags":639,"season":640,"assets":18,"type":9,"external_url":641,"layout":21},[],"2019-04-20-ocr-on-gov-docs.md","2019-1-20-similarity_is_as_similarity_does",{"id":652,"data":654,"filePath":660,"digest":661,"rendered":662,"legacyId":669},{"title":655,"excerpt":656,"tags":657,"season":658,"assets":18,"type":19,"external_url":659,"layout":21},"Similarity is as similarity does? A critical inquiry into the effect of thematic association on similarity","Paper published at Cognition: Similarity is as similarity does? A critical inquiry into the effect of thematic association on similarity. This work provides a better understanding of the curious case of thematic similarity, where thematic integration-driven similarity judgment behavior is found to be less frequent than thought.","cognition, similarity, thematic, taxonomic, categories, paper","winter 2019","http://kurtzlab.psychology.binghamton.edu/publications/honke%20and%20kurtz%202019.pdf","src/content/blog/2019-1-20-similarity_is_as_similarity_does.md","841392b95d50696a",{"html":25,"metadata":663},{"headings":664,"localImagePaths":665,"remoteImagePaths":666,"frontmatter":667,"imagePaths":668},[],[],[],{"title":655,"excerpt":656,"tags":657,"season":658,"assets":18,"type":19,"external_url":659,"layout":21},[],"2019-1-20-similarity_is_as_similarity_does.md","2019-1-24-simon",{"id":670,"data":672,"filePath":677,"digest":678,"rendered":679,"legacyId":686},{"title":673,"excerpt":674,"tags":675,"season":658,"assets":18,"type":19,"external_url":676,"layout":21},"SIMON - Semantic Inference for the Modeling of ONtologies","Colleagues and I submitted SIMON (preprint on arXiv). SIMON is a semantic classifier that uses the features of a character-level convolutional neural network to predict class membership. The algorithm shows impressive performance on tasks as diverse as social media account user age, tabular data column types (e.g., GPS coordinates, ordinal values, postal codes, etc.), and Spam classification.","python, categories, classification, machine learning, deep learning","https://arxiv.org/pdf/1901.08456.pdf","src/content/blog/2019-1-24-simon.md","4a225b0f66e72d9f",{"html":25,"metadata":680},{"headings":681,"localImagePaths":682,"remoteImagePaths":683,"frontmatter":684,"imagePaths":685},[],[],[],{"title":673,"excerpt":674,"tags":675,"season":658,"assets":18,"type":19,"external_url":676,"layout":21},[],"2019-1-24-simon.md","2019-10-01-disinfo-framework",{"id":687,"data":689,"filePath":695,"digest":696,"rendered":697,"legacyId":704},{"title":690,"excerpt":691,"tags":692,"season":693,"assets":18,"type":19,"external_url":694,"layout":21},"Disinformation: Detect to Disrupt","Our framework for combating online disinformation accepted to the Comparative Approaches to Disinformation workshop hosted by the Berkman Klien Center for Internet and Society.","disinformation","fall 2019","https://cyber.harvard.edu/story/2019-10/comparative-approaches-disinformation","src/content/blog/2019-10-01-disinfo-framework.md","1d34300994c6cb87",{"html":25,"metadata":698},{"headings":699,"localImagePaths":700,"remoteImagePaths":701,"frontmatter":702,"imagePaths":703},[],[],[],{"title":690,"excerpt":691,"tags":692,"season":693,"assets":18,"type":19,"external_url":694,"layout":21},[],"2019-10-01-disinfo-framework.md","2019-06-15-blog-slowdown",{"id":705,"data":707,"body":711,"filePath":712,"digest":713,"rendered":714,"legacyId":722},{"title":708,"excerpt":709,"season":710,"assets":18,"type":9,"layout":40},"Solve for X","Accepted a research scientist role focused on computational neursoscience and ml with a project in stealth mode housed at X (Alphabet's moonshot factory).","summer 2019","And that's all I can say about that.","src/content/blog/2019-06-15-blog-slowdown.md","32238155c0e310b2",{"html":715,"metadata":716},"\u003Cp>And that’s all I can say about that.\u003C/p>",{"headings":717,"localImagePaths":718,"remoteImagePaths":719,"frontmatter":720,"imagePaths":721},[],[],[],{"title":708,"excerpt":709,"season":710,"assets":18,"type":9,"layout":40},[],"2019-06-15-blog-slowdown.md","2019-7-20-kurtz_and_honke_2019",{"id":723,"data":725,"filePath":730,"digest":731,"rendered":732,"legacyId":739},{"title":726,"excerpt":727,"tags":728,"season":710,"assets":18,"type":19,"external_url":729,"layout":21},"Sorting Out the Problem of Inert Knowledge: Category Construction to Promote Spontaneous Transfer.","Our paper introducing the category status hypothesis for knowledge transfer accepted at JEP:LMC. We show in a series of experiments that learning a novel relational category through category construction improves spontaneous transfer.","similarity, cognition, categories, transfer, paper","/pdfs/manuscripts/kurtz-and-honke-2019-category-status.pdf","src/content/blog/2019-7-20-kurtz_and_honke_2019.md","7dc9430608c2db3d",{"html":25,"metadata":733},{"headings":734,"localImagePaths":735,"remoteImagePaths":736,"frontmatter":737,"imagePaths":738},[],[],[],{"title":726,"excerpt":727,"tags":728,"season":710,"assets":18,"type":19,"external_url":729,"layout":21},[],"2019-7-20-kurtz_and_honke_2019.md","2019-7-22-honke_kurtz_and_laszlo_2019",{"id":740,"data":742,"filePath":747,"digest":748,"rendered":749,"legacyId":756},{"title":743,"excerpt":744,"tags":745,"season":710,"assets":18,"type":19,"external_url":746,"layout":21},"Similarity Judgments Predict N400 Amplitude Differences between Taxonomic Category Members and Thematic Associates.","Submitted our latest on semantic knowledge organization (preprint at PsyArXiv) that provides evidence that N400 amplitude reliably differs for processing of taxonomic catgeory members and thematic associates; critically, the amplitude delta varies consistently with people's offline similarity judgment behavior.","similarity, cognition, neuroscience, paper","/pdfs/manuscripts/honke-et-al-psyarxiv-n400-similarity.pdf","src/content/blog/2019-7-22-honke_kurtz_and_laszlo_2019.md","faa7eb67e5be147d",{"html":25,"metadata":750},{"headings":751,"localImagePaths":752,"remoteImagePaths":753,"frontmatter":754,"imagePaths":755},[],[],[],{"title":743,"excerpt":744,"tags":745,"season":710,"assets":18,"type":19,"external_url":746,"layout":21},[],"2019-7-22-honke_kurtz_and_laszlo_2019.md","2020-02-01-taxonomic-similarity-and-n400-amplitude",{"id":757,"data":759,"filePath":764,"digest":765,"rendered":766,"legacyId":773},{"title":760,"excerpt":761,"tags":745,"season":762,"assets":18,"type":19,"external_url":763,"layout":21},"Similarity Judgments Predict N400 Amplitude Differences Accepted for Publication at Neuropsychologia","Paper on the correspondence between N400 amplitude and similarity processing accepted for publication at Neuropsychologia.","winter 2020","/pdfs/manuscripts/honke-etal-2020.pdf","src/content/blog/2020-02-01-taxonomic-similarity-and-n400-amplitude.md","74b6699edd95c562",{"html":25,"metadata":767},{"headings":768,"localImagePaths":769,"remoteImagePaths":770,"frontmatter":771,"imagePaths":772},[],[],[],{"title":760,"excerpt":761,"tags":745,"season":762,"assets":18,"type":19,"external_url":763,"layout":21},[],"2020-02-01-taxonomic-similarity-and-n400-amplitude.md","2020-11-02-amber-opensources",{"id":774,"data":776,"body":781,"filePath":782,"digest":783,"rendered":784,"legacyId":792},{"title":777,"excerpt":778,"season":779,"assets":18,"type":9,"external_url":780,"layout":40},"Amber shutdown","My Main project at X was opensourced today: Sharing Project Amber with the mental health community.","fall 2020","https://blog.x.company/sharing-project-amber-with-the-mental-health-community-7b6d8814a862?gi=d269516144d0","My Main project at X was opensourced today: Sharing Project Amber with the mental health community","src/content/blog/2020-11-02-amber-opensources.md","62a72011ff1ad37a",{"html":785,"metadata":786},"\u003Cp>My Main project at X was opensourced today: Sharing Project Amber with the mental health community\u003C/p>",{"headings":787,"localImagePaths":788,"remoteImagePaths":789,"frontmatter":790,"imagePaths":791},[],[],[],{"title":777,"excerpt":778,"season":779,"assets":18,"type":9,"external_url":780,"layout":40},[],"2020-11-02-amber-opensources.md","2019-5-25-dhamani-et-al-aisg-workshop",{"id":793,"data":795,"filePath":800,"digest":801,"rendered":802,"legacyId":809},{"title":796,"excerpt":797,"tags":798,"season":640,"assets":18,"type":19,"external_url":799,"layout":21},"Using Deep Networks and Transfer Learning to Address Disinformation","Paper accepted for presentation at ICML '19 AI for Social Good Workshop. The project tested an ensemble CNN-LSTM pipeline for text classification.","machine learning, CNN, LSTM, disinformation, paper","https://arxiv.org/pdf/1905.10412.pdf","src/content/blog/2019-5-25-dhamani-et-al-aisg-workshop.md","aff05efd58098095",{"html":25,"metadata":803},{"headings":804,"localImagePaths":805,"remoteImagePaths":806,"frontmatter":807,"imagePaths":808},[],[],[],{"title":796,"excerpt":797,"tags":798,"season":640,"assets":18,"type":19,"external_url":799,"layout":21},[],"2019-5-25-dhamani-et-al-aisg-workshop.md","2020-12-10-bvae-actigraphy-neurips-workshop",{"id":810,"data":812,"filePath":817,"digest":818,"rendered":819,"legacyId":826},{"title":813,"excerpt":814,"season":762,"assets":18,"tags":815,"type":19,"external_url":816,"layout":21},"Using Convolutional Variational Autoencoders to Predict Post-Trauma Health Outcomes from Actigraphy Data","Spotlight talk accepted at the NeuRIPS 2021 Machine Learning for Mobile Health workshop: Using Convolutional Variational Autoencoders to Predict Post-Trauma Health Outcomes from Actigraphy Data.","machine learning, unsupervised learning, psychopathology, actigraphy","https://nips.cc/virtual/2020/19556","src/content/blog/2020-12-10-bvae-actigraphy-neurips-workshop.md","a71c0444de5fd8e7",{"html":25,"metadata":820},{"headings":821,"localImagePaths":822,"remoteImagePaths":823,"frontmatter":824,"imagePaths":825},[],[],[],{"title":813,"excerpt":814,"season":762,"assets":18,"tags":815,"type":19,"external_url":816,"layout":21},[],"2020-12-10-bvae-actigraphy-neurips-workshop.md","2021-2-01-joined-cortex",{"id":827,"data":829,"body":831,"filePath":833,"digest":834,"rendered":835,"legacyId":843},{"title":830,"excerpt":831,"season":832,"assets":18,"type":9,"layout":40},"Joined the Cortex team","I joined the Cortex team at X. We do math, science, and machine learning for zero-to-one projects.","winter 2021","src/content/blog/2021-2-01-joined-cortex.md","5d5cd59790afbb66",{"html":836,"metadata":837},"\u003Cp>I joined the Cortex team at X. We do math, science, and machine learning for zero-to-one projects.\u003C/p>",{"headings":838,"localImagePaths":839,"remoteImagePaths":840,"frontmatter":841,"imagePaths":842},[],[],[],{"title":830,"excerpt":831,"season":832,"assets":18,"type":9,"layout":40},[],"2021-2-01-joined-cortex.md","2021-05-01-bvae-for-eeg",{"id":844,"data":846,"filePath":852,"digest":853,"rendered":854,"legacyId":861},{"title":847,"excerpt":848,"season":849,"assets":18,"tags":850,"type":19,"external_url":851,"layout":21},"REPRESENTATION LEARNING FOR IMPROVED INTERPRETABILITY AND CLASSIFICATION ACCURACY OF CLINICAL FACTORS FROM EEG","Our paper on bVAEs and disentanglement for intepretability and classification of clinical factors from EEG presented at ICLR 2021.","spring 2021","machine learning, unsupervised learning, psychopathology","https://openreview.net/pdf?id=TVjLza1t4hI","src/content/blog/2021-05-01-bvae-for-eeg.md","9987058dc928d831",{"html":25,"metadata":855},{"headings":856,"localImagePaths":857,"remoteImagePaths":858,"frontmatter":859,"imagePaths":860},[],[],[],{"title":847,"excerpt":848,"season":849,"assets":18,"tags":850,"type":19,"external_url":851,"layout":21},[],"2021-05-01-bvae-for-eeg.md","2022-03-01-amber-patents",{"id":862,"data":864,"body":868,"filePath":869,"digest":870,"rendered":871,"legacyId":879},{"title":865,"excerpt":866,"season":867,"assets":18,"type":9,"layout":40},"Amber Patents","We filed a ton of patents for technology supporting our work on advanced diagnostics and monitoring for mental health including filings on the earliest known use of transformer architectures for electrophysiological representation learning.","spring 2022","We filed a ton of patents for technology supporting our work on advanced diagnostics and monitoring for mental health including filings on the earliest known use of transformer architectures for electrophsiological representation learning.\n\n*Latent Factor Structuring of Psychopathology* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:UxriW0iASnsC) \n\n*De-noising task-specific electroencephalogram signals using neural networks* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:SP6oXDckpogC)\n\n*Processing time-frequency representations of EEG data using neural networks* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:uWQEDVKXjbEC)\n\n*Processing EEG data with twin neural networks* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:OU6Ihb5iCvQC)\n\n*Attention encoding stack in EEG trial aggregation* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:p2g8aNsByqUC)\n\n*Attention encoding stack in aggregation of data* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:XiSMed-E-HIC)\n\n*EEG signal representations using auto-encoders* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:u9iWguZQMMsC)\n\n*Resampling EEG trial data* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:Tiz5es2fbqcC)\n\n*Processing time-domain and frequency-domain representations of EEG data* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:WbkHhVStYXYCC)","src/content/blog/2022-03-01-amber-patents.md","51b440c9cc3f8566",{"html":872,"metadata":873},"\u003Cp>We filed a ton of patents for technology supporting our work on advanced diagnostics and monitoring for mental health including filings on the earliest known use of transformer architectures for electrophsiological representation learning.\u003C/p>\n\u003Cp>\u003Cem>Latent Factor Structuring of Psychopathology\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:UxriW0iASnsC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>De-noising task-specific electroencephalogram signals using neural networks\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:SP6oXDckpogC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Processing time-frequency representations of EEG data using neural networks\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:uWQEDVKXjbEC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Processing EEG data with twin neural networks\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:OU6Ihb5iCvQC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Attention encoding stack in EEG trial aggregation\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:p2g8aNsByqUC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Attention encoding stack in aggregation of data\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:XiSMed-E-HIC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>EEG signal representations using auto-encoders\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:u9iWguZQMMsC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Resampling EEG trial data\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:Tiz5es2fbqcC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Processing time-domain and frequency-domain representations of EEG data\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:WbkHhVStYXYCC\">Here\u003C/a>\u003C/p>",{"headings":874,"localImagePaths":875,"remoteImagePaths":876,"frontmatter":877,"imagePaths":878},[],[],[],{"title":865,"excerpt":866,"season":867,"assets":18,"type":9,"layout":40},[],"2022-03-01-amber-patents.md","2021-8-1-reservoir_nn_oss",{"id":880,"data":882,"body":886,"filePath":887,"digest":888,"rendered":889,"legacyId":897},{"title":883,"excerpt":884,"season":885,"assets":18,"type":9,"layout":40},"Valkyrie Reservoir_NN Package Released","We open-source our work enabling the use of adaptable reservoir layers for building neural networks in Keras. BYOR - Bring your own reservoir!","summer 2021","Check out the `reservoir_nn` package that enables user to BYOR - Bring your won reservoir! - and use the connectivity matrix as a plug-and-play layer in any arbitrary neural network built in Keras. Find the library [here](https://github.com/keras-team/reservoir_nn).","src/content/blog/2021-8-1-reservoir_nn_oss.md","6011fdd65eedb2bd",{"html":890,"metadata":891},"\u003Cp>Check out the \u003Ccode>reservoir_nn\u003C/code> package that enables user to BYOR - Bring your won reservoir! - and use the connectivity matrix as a plug-and-play layer in any arbitrary neural network built in Keras. Find the library \u003Ca href=\"https://github.com/keras-team/reservoir_nn\">here\u003C/a>.\u003C/p>",{"headings":892,"localImagePaths":893,"remoteImagePaths":894,"frontmatter":895,"imagePaths":896},[],[],[],{"title":883,"excerpt":884,"season":885,"assets":18,"type":9,"layout":40},[],"2021-8-1-reservoir_nn_oss.md","2022-06-01-proteome-project-patents",{"id":898,"data":900,"body":904,"filePath":905,"digest":906,"rendered":907,"legacyId":915},{"title":901,"excerpt":902,"season":903,"assets":18,"type":9,"layout":40},"Exploratory Interstitial Fluid Project Patents","We shutdown our investigation of a wearable lab and micro-needle array for online proteome analysis. Some patents from the effort apear here.","summer 2022","This project investigated how we could use online extraction and analysis of human interstitial fluid as a technique for monitoring health outcomes like acute kidney injury in humans.  \n\n*Reconstruction of sparse biomedical data* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:tOudhMTPpwUC) \n\n*Disease representation and classification with machine learning* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:08ZZubdj9fEC)","src/content/blog/2022-06-01-proteome-project-patents.md","78b420db47c24a46",{"html":908,"metadata":909},"\u003Cp>This project investigated how we could use online extraction and analysis of human interstitial fluid as a technique for monitoring health outcomes like acute kidney injury in humans.\u003C/p>\n\u003Cp>\u003Cem>Reconstruction of sparse biomedical data\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:tOudhMTPpwUC\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Disease representation and classification with machine learning\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:08ZZubdj9fEC\">Here\u003C/a>\u003C/p>",{"headings":910,"localImagePaths":911,"remoteImagePaths":912,"frontmatter":913,"imagePaths":914},[],[],[],{"title":901,"excerpt":902,"season":903,"assets":18,"type":9,"layout":40},[],"2022-06-01-proteome-project-patents.md","2022-06-02-reservoir_project-patents",{"id":916,"data":918,"body":921,"filePath":922,"digest":923,"rendered":924,"legacyId":932},{"title":919,"excerpt":920,"season":903,"assets":18,"type":9,"layout":40},"Reservoir  Patents","Patents filed for our effort to deploy facsimiles of real biological connectomes as interchangeable reservoirs in artificial neural networks.","This project investigated the effectiveness of using the connectivity structure of real biological connectomes (e.g., Drosophila) as interchangeable reservoir layers in SoTA neural architectures like UNets, LSTMs, and Transformers.  \n\n*Ensemble machine learning with reservoir neural networks* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:vRqMK49ujn8C) \n\n*Attention-based brain emulation neural netowrks* \n\n[Here](https://scholar.google.com/citations?view_op=view_citation&hl=en&user=WPewiKcAAAAJ&sortby=pubdate&citation_for_view=WPewiKcAAAAJ:l7t_Zn2s7bgC)","src/content/blog/2022-06-02-reservoir_project-patents.md","e7238a3921690384",{"html":925,"metadata":926},"\u003Cp>This project investigated the effectiveness of using the connectivity structure of real biological connectomes (e.g., Drosophila) as interchangeable reservoir layers in SoTA neural architectures like UNets, LSTMs, and Transformers.\u003C/p>\n\u003Cp>\u003Cem>Ensemble machine learning with reservoir neural networks\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:vRqMK49ujn8C\">Here\u003C/a>\u003C/p>\n\u003Cp>\u003Cem>Attention-based brain emulation neural netowrks\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"https://scholar.google.com/citations?view_op=view_citation&#x26;hl=en&#x26;user=WPewiKcAAAAJ&#x26;sortby=pubdate&#x26;citation_for_view=WPewiKcAAAAJ:l7t_Zn2s7bgC\">Here\u003C/a>\u003C/p>",{"headings":927,"localImagePaths":928,"remoteImagePaths":929,"frontmatter":930,"imagePaths":931},[],[],[],{"title":919,"excerpt":920,"season":903,"assets":18,"type":9,"layout":40},[],"2022-06-02-reservoir_project-patents.md","2022-12-1-molt5-emnlp2022",{"id":933,"data":935,"filePath":941,"digest":942,"rendered":943,"legacyId":950},{"title":936,"excerpt":937,"season":938,"assets":18,"tags":939,"type":19,"external_url":940,"layout":21},"Translation between Molecules and Natural Language","MolT5 - our work evaluating transformers for text-to-text transfer between natural language and molecular information accepted for oral presentation at EMNLP2022.","winter 2022","machine learning, self-supervised learning, chemistry","https://aclanthology.org/2022.emnlp-main.26/","src/content/blog/2022-12-1-molt5-emnlp2022.md","ee1e7c0da484b6be",{"html":25,"metadata":944},{"headings":945,"localImagePaths":946,"remoteImagePaths":947,"frontmatter":948,"imagePaths":949},[],[],[],{"title":936,"excerpt":937,"season":938,"assets":18,"tags":939,"type":19,"external_url":940,"layout":21},[],"2022-12-1-molt5-emnlp2022.md","2024-08-01-concept-learning",{"id":951,"data":953,"filePath":958,"digest":959,"rendered":960,"legacyId":967},{"title":954,"excerpt":955,"season":956,"type":19,"external_url":957,"layout":21},"Improving Concept Learning in Education via Category Construction","Investigating the effects of category construction on concept learning in educational settings. Published in the Journal of Educational Psychology.","summer 2024","https://psycnet.apa.org/record/2025-20587-001","src/content/blog/2024-08-01-concept-learning.md","7ae02f06932ecf42",{"html":25,"metadata":961},{"headings":962,"localImagePaths":963,"remoteImagePaths":964,"frontmatter":965,"imagePaths":966},[],[],[],{"title":954,"excerpt":955,"season":956,"type":19,"external_url":957,"layout":21},[],"2024-08-01-concept-learning.md","2024-04-02-lawinstruct",{"id":968,"data":970,"filePath":975,"digest":976,"rendered":977,"legacyId":984},{"title":971,"excerpt":972,"season":973,"type":19,"external_url":974,"layout":21},"LawInstruct: A Resource for Studying Language Model Adaptation to the Legal Domain","Exploring the effectiveness of instruction-tuning data mixtures for legal reasoning and introducing the LawInstruct dataset. Accepted at NAACL 2025.","spring 2025","https://arxiv.org/abs/2404.02127","src/content/blog/2024-04-02-lawinstruct.md","3ec183400eb34ad1",{"html":25,"metadata":978},{"headings":979,"localImagePaths":980,"remoteImagePaths":981,"frontmatter":982,"imagePaths":983},[],[],[],{"title":971,"excerpt":972,"season":973,"type":19,"external_url":974,"layout":21},[],"2024-04-02-lawinstruct.md","2024-05-10-lmd3",{"id":985,"data":987,"filePath":992,"digest":993,"rendered":994,"legacyId":1001},{"title":988,"excerpt":989,"season":990,"type":19,"external_url":991,"layout":21},"LMD3: Language Model Data Density Dependence","Analyzing language model task performance at the individual example level based on training data density estimation. Presented at CoLM 2024.","spring 2024","https://arxiv.org/abs/2405.06331","src/content/blog/2024-05-10-lmd3.md","bd9ecf06c3da1fec",{"html":25,"metadata":995},{"headings":996,"localImagePaths":997,"remoteImagePaths":998,"frontmatter":999,"imagePaths":1000},[],[],[],{"title":988,"excerpt":989,"season":990,"type":19,"external_url":991,"layout":21},[],"2024-05-10-lmd3.md","2025-05-14-jules-io-2025",{"id":1002,"data":1004,"body":1008,"filePath":1009,"digest":1010,"rendered":1011,"legacyId":1019},{"title":1005,"excerpt":1006,"season":973,"type":9,"tags":1007,"layout":40},"Jules: Google's AI Coding Agent Launches at I/O 2025","Launched Jules, an asynchronous coding agent at Google I/O","jules, google io, ai coding","I'm excited to share that we launched **Jules**, Google's AI-powered coding agent at Google I/O 2025! Jules takes you from Github issue to PR with a single prompt.","src/content/blog/2025-05-14-jules-io-2025.md","e45752906235ea75",{"html":1012,"metadata":1013},"\u003Cp>I’m excited to share that we launched \u003Cstrong>Jules\u003C/strong>, Google’s AI-powered coding agent at Google I/O 2025! Jules takes you from Github issue to PR with a single prompt.\u003C/p>",{"headings":1014,"localImagePaths":1015,"remoteImagePaths":1016,"frontmatter":1017,"imagePaths":1018},[],[],[],{"title":1005,"excerpt":1006,"season":973,"type":9,"tags":1007,"layout":40},[],"2025-05-14-jules-io-2025.md","2025-02-01-joined-deepmind",{"id":1020,"data":1022,"body":1027,"filePath":1028,"digest":1029,"rendered":1030,"legacyId":1038},{"title":1023,"excerpt":1024,"season":1025,"type":9,"tags":1026,"layout":40},"Programming Programs to Program at Google DeepMind","I've joined Google DeepMind as a Staff Research Scientist to work on programming programs to program.","winter 2025","career, google deepmind, gemini","I've joined **Google DeepMind** as a Staff Research Scientist working on advancing the coding capabilities of the **Gemini** models.","src/content/blog/2025-02-01-joined-deepmind.md","4aaf66e5a6a4f324",{"html":1031,"metadata":1032},"\u003Cp>I’ve joined \u003Cstrong>Google DeepMind\u003C/strong> as a Staff Research Scientist working on advancing the coding capabilities of the \u003Cstrong>Gemini\u003C/strong> models.\u003C/p>",{"headings":1033,"localImagePaths":1034,"remoteImagePaths":1035,"frontmatter":1036,"imagePaths":1037},[],[],[],{"title":1023,"excerpt":1024,"season":1025,"type":9,"tags":1026,"layout":40},[],"2025-02-01-joined-deepmind.md","2025-07-01-gemini-2-5",{"id":1039,"data":1041,"filePath":1046,"digest":1047,"rendered":1048,"legacyId":1055},{"title":1042,"excerpt":1043,"season":1044,"type":19,"external_url":1045,"layout":21},"Gemini 2.5: Pushing the Frontier with Advanced Reasoning, Multimodality, Long Context, and Next Generation Agentic Capabilities","Introducing Gemini 2.5: Pushing the Frontier with Advanced Reasoning, Multimodality, Long Context, and Next Generation Agentic Capabilities","summer 2025","https://arxiv.org/abs/2507.06261","src/content/blog/2025-07-01-gemini-2-5.md","2e4f275b693564e9",{"html":25,"metadata":1049},{"headings":1050,"localImagePaths":1051,"remoteImagePaths":1052,"frontmatter":1053,"imagePaths":1054},[],[],[],{"title":1042,"excerpt":1043,"season":1044,"type":19,"external_url":1045,"layout":21},[],"2025-07-01-gemini-2-5.md"]